Earth and Space Science RESEARCH ARTICLE 10.1029/2020EA001530 Key Points: ¢ We report 18 new electron diffusion region (EDR) candidates close to the Earth magnetopause in the Magnetospheric Multiscale Mission (MMS) phase 1a data using a neural network ¢ The algorithm makes use of a scalar quantity called “MeanRL” to identify the electron perpendicular agyrotropy typical of EDRs from MMS distribution functions ¢ We analyze and discuss the geometry of EDR based on energy dissipation signatures Correspondence to: Q.
Lenouvel, quentin.lenouvel@irap.omp.eu Citation: Lenouvel, Q., Génot, V., Garnier, P., Toledo-Redondo, S., Lavraud, B., Aunai, N., et al.
(2021).
Identification of electron diffusion regions with a machine learning approach on MMS data at the Earth's magnetopause.
Earth and Space Science, 8, e2020EA001530.
https://doi.org/10.1029/2020EA001530 Received 9 NOV 2020 Accepted 11 APR 2021 © 2021.
The Authors.
Earth and Space Science published by Wiley Periodicals LLC on behalf of American Geophysical Union.
This is an open access article under the terms of the Creative Commons Attribution-NonCommercial-NoDerivs License, which permits use and distribution in any medium, provided the original work is properly cited, the use is non-commercial and no modifications or adaptations are made.
LENOUVEL ET AL.
® Check for updates Rh yo L [ ADVANCING PALI GS space science oy Identification of Electron Diffusion Regions with a Machine Learning Approach on MMS Data at the Earth's Magnetopause Q.
Lenouvel! ©, V.
Génot’, P.
Garnier! ©, S.
Toledo-Redondo’” ©, B.
Lavraud?” ©, N.
Aunai‘* ©, G.
Nguyen‘ ©, D.
J.
Gershman’ ©, R.
E.
Ergun’ ©, P.-A.
Lindqvist’ ©, B.
Giles® ©, and J.
L.
Burch® ‘Institut de Recherche en Astrophysique et Planétologie, Centre national de la recherche scientifique, Université Toulouse 3, Centre national d'études spatiales, Toulouse, France, “Department of Electromagnetism and Electronics, University of Murcia, Murcia, Spain, *Laboratoire d'Astrophysique de Bordeaux, CNRS, Université de Bordeaux, France, “CNRS, Ecole polytechnique, Sorbonne Université, Univ Paris Sud, Observatoire de Paris, Université Paris-Saclay, PSL Research University, Laboratoire de Physique des Plasmas, Palaiseau, France, "NASA Goddard Space Flight Center, Greenbelt, MD, USA, “Department of Astrophysical and Planetary Sciences, University of Colorado Boulder, Boulder, CO, USA, ’KTH Royal Institute of Technology, Stockholm, Sweden, “Southwest Research Institute, San Antonio, TX, USA Abstract This article presents 18 magnetic reconnection electron diffusion region (EDR) candidates found using a neural network algorithm with the Magnetospheric Multiscale Mission phase 1a data at the Earth's dayside magnetopause.
These new candidates are compared to the 32 previously reported dayside EDRs listed in Webster et al.
(2018), https://doi.org/10.1029/2018ja025245, which constitute the training database of our algorithm.
One of the main parameters used is a scalar quantity called “MeanRL’” which is based on the asymmetry of the electron velocity distribution function and better identifies electron agyrotropy in the plane perpendicular to the magnetic field.
In the light of the new EDR candidates found, we discuss and analyze the sign of the energy dissipation during the reconnection process and the distinction between the inner and outer EDRs, with 40% of the candidates showing negative or oscillating dissipation.
We also present in details one of the new identified EDR candidates.
1.
Introduction Magnetic reconnection is a fundamental plasma process that allows energy from the magnetic fields to be transferred to the surrounding particles in the form of kinetic and thermal energy.
During this process, non collinear magnetic field lines change their connectivity.
Although reconnection has global-scale consequences, it is triggered in a small diffusion region at kinetic scales.
At these scales the frozen-in plasma condition must be broken in order to allow the topological modification of the field lines to occur.
The diffusion region can be decomposed into an ion diffusion region (IDR) and an electron diffusion region (EDR) in which respectively ions and electrons decouple from the magnetic field (Priest & Forbes, 2000).
The EDR is of particular interest as it is the region responsible of initiating magnetic reconnection and it is also where the energy conversion process takes place.
Finding new EDRs to study is crucial to better understand the physics involved within.
The existence of the EDR had been theorized for many years but its observation remained elusive because of its small spatial extension (a few kilometers only at the magnetopause) until the launch of the Magnetospheric Multiscale Mission (MMS) (Burch, Moore, et al., 2016; Burch, Torbert, et al., 2016).
The MMS was launched on March 13 2015.
The goal of the mission is to study the interaction between the Sun's solar wind and the Earth's magnetosphere, and more precisely the magnetic reconnection process.
MMS is composed of four identical spacecraft flying in a close tetrahedron formation with an adjustable separation.
Each spacecraft is equipped with several instruments among which can be found the Fluxgate Magnetometers (Russell et al., 2016) and the electric field double probes (EDPs) (Lindqvist et al., 2016) measuring the magnetic and the electric fields respectively, as well as the fast plasma investigation (FPI) (Pollock et al., 2016) performing three dimensional measurements of electrons and ions velocity distribution functions at the highest resolution ever provided for a space mission (30 ms for electrons and 150 ms 1 of 18 fri AGU ADVANCING EARTH AND SPACE SCIENCE LENOUVEL ET AL.
Earth and Space Science 10.1029/2020EA001530 for ions).
The nominal mission plan was of 2 years during which the spacecraft would travel in two different equatorial, highly elliptical Earth orbits.
The first year and a half of the nominal mission was defined as phase 1 and was dedicated to the study of the day-side magnetopause, and the last 6 months were focused on the study of reconnection in the magnetotail on the night-side.
The MMS has already enabled the community to manually identify EDR crossings on the dayside (asymmetric reconnection) and on the nightside (symmetrical reconnection) of the magnetosphere.
Magnetotail campaigns with MMS were the sources of many recent EDR studies (e.g., Chen et al., 2019; Hwang et al., 2019), with older studies being more focused on EDRs found at the magnetopause.
A total of 32 reported dayside EDRs from the phase 1 of MMS are listed in Webster et al.
(2018).
One of the main criteria of selection for these EDRs is the presence of crescents in the electron velocity distribution functions provided by FPI.
The other selection criteria were high absolute values of dissipation J.E or J.E’, with J the magnetic current, E the electric field, and E’ the electric field in the electron frame defined as E’ = E + V, x B, and low magnetic field B, values (in the Geocentric Solar Ecliptic (GSE) coordinate system).
Unfortunately, the identification of EDRs remains difficult, since all these prerequisites are not always satisfied in the identified cases we know of.
This list was the starting point of our study as it provided the EDR cases that we used to train our machine learning algorithm.
Machine learning has proven to be an incredibly powerful tool to process large amounts of data, such as provided by the MMS.
The interest of the scientific community toward the field of big data and the machine learning techniques has been growing for the last few years with applications like automatic detection and the classification of astrophysical events among others (e.g., Argall et al., 2020; Nguyen et al., 2019).
Machine Learning algorithms can be split into two different categories of learning: the first one is supervised, when an algorithm learns by iteratively minimizing its prediction error after comparison with existing labels.
The second one is unsupervised, when an algorithm learns by minimizing method-specific parameters allowing for the determination of patterns in the data resulting in a prediction.
Supervised learning usually gives better results than unsupervised learning, but it requires the production of a radiolabeled database for the training, which is usually very time consuming.
Within these two frames of work, machine learning algorithms are able to perform three different tasks: the first one is regression, when an algorithm predicts the evolution of a continuous variable by creating a numerical model based on relationships between parameters linked to that variable.
The second task is called clustering, when an algorithm groups a set of data points that appear similar without defining groups a priori.
The last application is classification, when an algorithm groups a set of new data points in predefined groups based on observations of other data points belonging to each group.
Using machine learning can be very useful and powerful in many applications as it allows for the production of perfectly reproducible lists of predictions contrary to visual inspection and it also allows for the analysis of very complex parameters.
In this study, we will explain the classification method we used to detect new EDRs in the MMS data at the magnetopause using machine learning.
Section 2 describes the known physical characteristics of the EDR.
Section 3 explains in detail the machine learning algorithm and the methods that were used.
Section 4 presents the list of new EDR candidates found by the algorithm as well as an illustration of one of these new events.
Section 5 discusses some of the new results and Section 6 summarizes this study.
2.
Characteristics of the Electron Diffusion Region The MMS was launched by NASA in March 2015 to specifically study the EDR and has already allowed breakthroughs in their comprehension (e.g., Burch and Phan, 2016; Chen et al., 2017; Fuselier et al., 2017; Phan et al., 2016).
One of the key features of EDRs is the existence of crescent-shaped electron velocity-space distribution functions, previously predicted by particle-in-cell (PIC) simulations (Hesse et al., 2014) and observed for the first time in the MMS data (Burch, Moore, et al., 2016; Burch, Torbert, et al., 2016).
The crescent-shaped electron velocity distribution functions are formed by solar wind electrons coming from the magnetosheath side that have enough energy to flow into the magnetosphere side and whose orbit extend into the magnetosphere through finite gyroradius effect.
With the action of the electric field, electrons follow a crescent-shaped meandering trajectory formed by the intersection of two different circular motions near the plasma boundary (Bessho et al., 2016).
It is worth noting that crescent distributions are 2 of 18 fri AGU ADVANCING EARTH AND SPACE SCIENCE LENOUVEL ET AL.
Earth and Space Science 10.1029/2020EA001530 characteristic of high shear angle reconnection events because the introduction of a guide field reduces the intensity of these distributions (Genestreti et al., 2017).
Electron Diffusion Regions are located around the X-point, where the magnetic field lines change their connectivity.
Null or relatively low magnetic intensities are thus theoretically expected in these regions.
On the dayside of the magnetosphere, the X-point and the flow stagnation point are separate and the EDR exhibits slightly different physics at these two points (Hesse et al., 2021).
Another indicator of diffusion regions is the specific terms that support the electric field among those of the generalized Ohm's law that can be written: Bye Ba nv B+ {LED vncyy vere) (1) en en\ e Ot where m, is the electron mass, e is the fundamental unit of charge, n is the plasma number density, v, is the bulk electron velocity, v; is the bulk ion velocity, J is the current density, and 7 is an anomalous resistivity that permits reconnection to occur at high rates.
With this form of Ohm's law, nonzero values for terms on the right-hand side represent a departure from ideal magnetohydrodynamics, which is expected to occur in the EDRs and IDRs.
However, E + V.
x B can become unreliable for EDR identification for events with non-negligible guide field.
The measurement of the rapidly changing E field is indeed a problem and it is difficult to draw conclusions by solely looking at the variation in time of this parameter.
It is usually better to look at the correlation of this parameter with the energy dissipation J.E or the total energy dissipation J.(E + V.
x B) (Zenitani et al., 2011), which is a scalar and has the advantage to be frame-independent.
Moreover, this parameter seems to be less affected by the presence of a guide field than the terms of the Ohm's law.
Energy dissipation is expected to be positive and large inside diffusion regions, indicating the energy conversion from the electromagnetic fields to the particles, although cases where J.E can be negative in or near the EDR exist and are discussed in Section 5.
3.
Machine Learning Algorithm 3.1.
Building of the Neural Network Machine learning algorithms can be used for three different kinds of tasks: regression, clustering, and classification.
We use classification for the identification of EDRs among all the magnetopause crossings data from phase la of MMS.
Phase 1a went from September 1 2015, to March 8 2016.
There are many types of machine learning algorithms that can be used to do classification tasks.
We chose to use a classical multilayer perceptron (Rumelhart et al., 1986).
Even though this architecture does not take the temporal context into account like state of the art long short-term memory type algorithms (Hochreiter & Schmidhuber, 1997), it has the advantage to require less training data and computing resources to obtain satisfying results.
Details about the architecture of the neural network can be found in Appendix.
The problem of identifying EDRs with machine learning brings a number of challenges, the first one being the training of the algorithm due to the scarce amount of available data.
The 32 previously reported cases provide a small amount of data points that can be used to train the algorithm to recognize EDRs compared to the amount of data generally used in big data applications.
The second challenge is the “feature selection,” which is the selection of the best physical parameters to provide the algorithm due to our lack of complete understanding of the microphysics inside EDRs.
Solutions to these problems are proposed in this article.
With this algorithm we choose to identify EDRs as well as three other classes: separatrix plus IDRs, magnetosphere (MSP) regions, and magnetosheath plus boundary layer (MBL) regions.
We chose this approach to be able to better contextualize the EDR detections regarding the location of the other plasma regions, but a detailed discussion of the detection of the other plasma regions is beyond the scope of this study.
Although the detection of EDRs was our main objective, studying and trying to detect these other plasma regions was of interest for our study to see how the physical parameters describing the EDR compared to those describing these other regions.
Separatrices and IDRs are grouped together because they exhibit similar features and are often difficult to distinguish from each other.
For similar reasons, we also group magnetosheath 3 of 18 fri AGU ADVANCING EARTH AND SPACE SCIENCE Network hyperparameters (architecture) Earth and Space Science 10.1029/2020EA001530 Labeled input data from previously reported cases Metrics F-measure Training of a model Best model Unlabeled input data from magnetopause crossings during phase la Training of the final mode! For each time step Predicted class B Neuron activation intensity Trained final model Neuron activation intensity > 0.8 i — iz — _ Artificial neural Network Predictions Postprocessing for the predictions 3 Corrected J.E > 1000 pW/m predictions At least 2 consecutive i EDR data point predictions ; _— Plots with the Neural ae Network's predictions Selection of good candidates New EDR candidates list Figure 1.
Flowchart of the process of the algorithm.
Orange rectangles represent parameters that could be tuned by the user and green rectangles represent outputs of the process it is linked to.
LENOUVEL ET AL.
and boundary layer.
Figure 1 shows a flowchart describing the whole process of the algorithm that we will now describe.
3.2.
Selection of the Features We used the list of 32 EDR events from Webster et al.
(2018) to build a training database for our algorithm.
We manually radiolabeled data points in 80 s burst data intervals taken around the reported EDR events.
Some of the reported events were not included into the training database, based on the visual inspection of the electron distribution functions, namely events 13, 15, 22, 23, 24, and 30, since deciding which data points could be considered as actually belonging to the EDR was ambiguous for these events by looking at each electron distribution function around the reported times.
Treating the 4 spacecraft independently, we gathered 200 individual EDR data points for the EDR training database.
For the other classes (IDR, magnetosphere, and boundary layer), the number of data points per class for the training database is 6809, 5334, and 18,334, respectively, taken from the multiple 80-s burst intervals.
4 of 18 fri AGU ADVANCING EARTH AND SPACE SCIENCE LENOUVEL ET AL.
Earth and Space Science 10.1029/2020EA001530 We then chose the relevant physical parameters to feed the algorithm, which we will refer to as “features” in the rest of this article.
The selection of the features was made to reflect our current understanding of EDRs while still being able to identify the other plasma regions of interest.
Thus, we chose features characterizing the magnetic field, the generalized Ohm's law, and the presence of electron physics including crescents in the velocity distribution functions.
The features that were provided to the algorithm are the following: ¢ The magnetic field (FGM): B,, |BI * The ion velocity (FPI): Vix, Viy, Viz ¢ The electron density (FPI): n, ¢ The electric field (EDP): FE), EF, ¢ The electric current (computed from EDP, FGM and FPI data): J), J, JxB en ¢ The terms of the generalized Ohm's law (computed from FPI data): (E+ V.
x B),,(E + V; x B), L ¢ The energy dissipation (computed from FPI and EDP data): J.E ¢ The electron temperature (FPI): Te, Te, ¢ The MeanRL (see Section 3.3) The x, y, z coordinates correspond to GSE coordinates while the parallel and perpendicular coordinates correspond to field aligned coordinates (I, L;, 12).
Field aligned coordinates for a vector V are obtained by first taking the dot product of the vector V and the magnetic field vector B to get V.
The V,, coordinate can be obtained by taking the dot product of V and B x [1, 0, 0].
The final coordinate Vi, is obtained by taking the dot product of V and the vector B x (B x [1, 0, 0]).
The perpendicular coordinate given here is the mean of the values of the two perpendicular coordinates L,; and 1.
The electric current J is computed from particle measurements (FPI) using a single spacecraft.
Figure 2 shows boxplots of the distributions of different physical parameters for each plasma region we manually radiolabeled during phase 1a, which constitutes our training database.
The boxplot graphical representation gives information on the dispersion of the data within a class.
From these boxplots, we can see that most of the parameter distributions do not allow a threshold approach as for each parameter; at least two classes usually have close ranges of values.
The absence of simple thresholds for each class (in particular for the IDR and EDR) is one of the main reasons for choosing a neural network approach, which by contrast allows for the building of a complex relationship between several physical parameters.
Nevertheless, the different regimes and characteristics expected for the different classes are found in the boxplots: IDRs exhibit a wide range of values for the terms in the Ohm's law, MSPs are characterized by low particle density (Figure 2b) and large magnetic field (Figure 2a), whereas boundary layer regions show a wide range of values for the intensity of the magnetic field (B,, Figure 2a), and large electron density (Figure 2b), but small energy dissipation (J.E, Figure 2c).
The EDR class is characterized, as expected, by a strong dissipation (J.E), nonideal Ohm's law components, and relatively low magnetic field intensities.
We initially considered the agyrotropic index Jo introduced by Swisdak (2016) (see also Aunai et al., 2013), which gives a measure of the nongyrotropy of a particle distribution based on the measured pressure tensor.
However, in our analysis, it was proven inefficient to identify EDRs, their values for the EDR class are indeed very close to the values of other classes and in particular magnetospheric like regions (Figure 2g).
This can be explained by the fact that when the particle counts are low (below 5 cm) like in the magnetosphere, the off-diagonal components of the pressure tensor in a field aligned basis are less reliable (close to noise level), which frequently results in large and nonphysical values for this parameter.
That is the reason why we chose not to include the agyrotropy index as a feature for the algorithm.
On the other hand, the MeanRL parameter that we defined is performing much better to separate the different classes (Figure 2h), the range of values for the EDR class being larger than that of all the other classes.
A detailed description of the MeanRL parameter can be found in Section 3.3.
3.3.
The MeanRL Parameter The MeanRL parameter is an adimensional scalar value created from the electron velocity distribution function to help spotting potential crescents.
These EDR crescents are located in the V,;, V, plane in 5 of 18 Arztl .
NY Earth and Space Science 10.1029/2020EA001530 Bz [nT] ne [cm™] J.E [pWim™] 50 a) b)| 30000 3) c) 60 8 40 5 20000 40 8 5 20 = 10000 .
20 0 + -20 ° 10 10000 —40 8 8 LJ —20000 Oo —60 0 O EDR IDR Msp BL EDR IDR Msp BL EDR IDR Msp BL (JxB)) mim] (E+VexB)), [mV/m] (E+VixB)  [mV/m] an 8 d) 20 10 0 -10 -20 , .
EDR IDR MSp BL EDR IDR Msp BL EDR IDR Msp BL Qroot 0.20 g 0.15 Oo ° 0.10 O 0.05 0.00 EDR IDR MSp BL EDR IDR MSp BL Figure 2.
Boxplot distribution of the values of different features for manually radiolabeled data points during phase 1a for each class.
The four classes are: electron diffusion region (EDR), ion diffusion region + separatrix IDR), magnetosphere region (MSP), and boundary layer region (BL).
They contain 200, 6809, 5334, and 18,334 points, respectively.
Each rectangle contains 50% of the values of the distribution and is delimited by Q, and Q; being the first and third quartiles; the yellow lines represent the median of the distribution.
Black circles are outliers of the distribution; they are defined by being below the threshold Q, — 1.5 X (Q3 — Q,) or above the threshold Q; + 1.5 x (Q3 — Q)).
the magnetic field-aligned coordinate system, on the positive V,, side of the electron velocity distribution function.
In this case, the definition of the coordinate system is different than previously explained; here, V, is still in the direction of the magnetic field, but V,; is in the direction of V.
and V__» is along the direction of V| X V,1.
The distribution function from which MeanRL is computed is the result of the integration of the LENOUVEL ET AL.
6 of 18 fri AGU ADVANCING EARTH AND SPACE SCIENCE LENOUVEL ET AL.
Earth and Space Science 10.1029/2020EA001530 2016-01-10TT09:13:36.740 2016-01-10TT09:13:36.740 , 10 26 | Figure 3.
Left: electron velocity distribution function (f) taken inside an EDR and presenting a crescent on the positive Vperp1 side in the V1, V,.2 plane.
Right: normalization by ring of the electron velocity distribution function (f’) on the left to compute the MeanRL scalar.
V,, and V,, are in 10° kms *.
The two white circles delimit the range of energies [40 eV, 275 eV].
—— Vperp2 Vperp2 Vperpl full 3D distribution function over a +15° angle above and below the V,;, V,, plane.
To compute the MeanRL parameter, to remove the energy dependence of the phase space densities, each bin of the distribution function fis first normalized by the mean of the bins at the same energy: F(E,) F(E,) LAG =) =€)) (2) 1 where €, = smelVin + Vi») is the perpendicular energy with m, the mass of the electron.
This also enhanc es the contrast between the two sides of the image in case of an asymmetry in the distribution function.
Then, the MeanRL is computed with the following formula: LAV > 08 <E, <&) MeanRL = tS (3) LAV <0,E << €, <&) where €&, = 40 eVand €, = 275 eV as EDR crescents are not expected outside of this energy range.
The result of these transformations is shown in Figure 3.
The range of the MeanRL parameter can go from 0 to 1 if there is a crescent shape on the left and above 1 if there is a crescent shape on the right.
In the context of looking for EDRs that show exclusively crescents on positive V_; side of electron velocity distribution functions, values over 2 and beyond are usually expected.
The highest observed values yet go up to around 8.
Sometimes, when dealing with distribution functions displaying high fluxes, the MeanRL may be high even though no crescent is present but a small asymmetry.
Indeed with our current computation method, phase space elements with high phase space densities have more weight than elements with smaller phase space densities giving rise to some false positives.
An enhancement of the current MeanRL computation method will be discussed in a future study, based on methods such as convolutionnal neural networks.
3.4.
Pre-processing of the Training Dataset The MMS was designed to explore electron physics during reconnection in more depth than previous magnetospheric missions and thus provides data with a resolution of 30 ms for the electrons and 150 ms for the ions.
However, MMS also provides measurements with even higher resolutions for the electric and magnetic fields of 0.01 and 0.96 ms, respectively.
Since our features contain both particle and field measurements taken at different rates, we upsampled the ion measurements on the times of the electron measurements using linear interpolation and we downsampled the magnetic field and electric field measurements on the electron measurements as well by taking the means of the measurements around the electron measurement 7 of 18 fri AGU ADVANCING EARTH AND SPACE SCIENCE LENOUVEL ET AL.
Earth and Space Science 10.1029/2020EA001530 times.
The data points used in this work correspond to 30 ms time intervals, that is, the nominal FPI electron measurement cadence.
The last modification we performed to our database was to remove outlier points.
Since the data points were all manually radiolabeled and since it is usually hard to clearly identify which data points constitute the boundaries between the different plasma regions, it is possible that some of the manually radiolabeled data points were mislabeled.
So, based on boxplots of all features for each class, we chose to remove in all the classes except for the EDR class the data points that were outliers of the distribution, defined by being below the threshold Q,; — 1.5 x (Q3 — Q,) or above the threshold Q; + 1.5 x (Q; — Q,) for at least one feature, with Q, and Q; being the first and third quartiles.
No EDR points were removed because it is already the smallest class of the dataset.
The number of data points for each class after removing outliers is 5037 (initially 6809) for the IDR class, 4201 (initially 5334) for the Magnetosphere class, 12,870 (initially 18,334) for the Boundary Layer class, and 200 for the EDR class.
All the resampled values for the features of our remaining manually radiolabeled data constitutes our training database.
In the machine learning field, it is common practice to split this training database into a training, a validation, and a test set.
The first one is the set from which the algorithm is going to learn, the second one is used to control the parameters used during the learning of the algorithm and is never used to train the algorithm, and the last one is used to assess the performances of the algorithm before using it on unseen data.
Due to the great imbalance in the number of data points available for each class, we used a stratified splitting which keeps the proportion of the classes in each set.
The repartition of the training database data points in each set is 60% for the training set, 20% for the validation set, and 20% for the test set.
Thus, for the EDR class, 60% of all available data points go into the training set and the remaining 40% are equally split between the validation and the test sets.
At this point, we standardized the data for each feature, which is a transformation yielding a mean of 0 and a standard deviation of 1 for the distribution, to keep a priori the same importance for all features.
3.5.
Training of the Algorithm The performance of the trained algorithm can be assessed by looking at different metrics that are chosen depending on the problem at hand and computed for each class.
We chose to look at three metrics being the Precision, the Recall, and the F1-score.
The Precision tells which proportion of positive identifications was effectively correct while the Recall tells which proportion of positive results was correctly identified.
A low Precision means that the algorithm will tend to overestimate the number of instances of the class and a low Recall means that the algorithm will overlook a lot of instances of the class.
Usually, increasing one of these metrics means the decrease of the other so depending on the application, one can prefer to either balance these two metrics or maximize one at the expense of the other.
For our goal of finding new EDRs, a high Recall was necessary in order not to miss too many cases so a lower Precision was tolerated.
The F-measure metric is the harmonic mean of the Precision and the Recall and is used to see the balance between these two metrics.
The formulas of these metrics are the following: TP Precision = —————— (4) TP + FP TP Recall = ————— (5) TP + FN , (Pre x Rec) Pre + Rec F1— score = 2 (6) where TP, FP, and FN, respectively, stand for number of true positives, false positives, and false negatives, and Pre and Rec, respectively, refer to Precision and Recall.
Using the training and validation sets, we then tried to find the neural network architecture that would give the best metrics, being in our case the highest possible Recall with still a relatively high Precision to limit 8 of 18 [Vela me \ A ADVANCING EARTH AND SPACE SCIENCE Table 1 Results of the Training of the Algorithm Test data Class points EDR 40 IDR + separatrix region 1008 Magnetosphere 840 Boundary layer 2574 LENOUVEL ET AL.
Earth and Space Science 10.1029/2020EA001530 the number of false positives.
As said in the beginning of this section, the scarce number of EDR data points was problematic for the training Precision Recall.
Fl-score of the algorithm, as the number of data points between the four classes (%) (%) (%) was very unbalanced.
To tackle this problem, during the training we used weights to give more importance to the smallest classes.
These weights ee 2 88 are computed by attributing to each point the inverse of the apparition 97 97 37 frequency of the class it belongs to.
The results of the training can be 98 100 aD found in Table 1.
The algorithm performs very well for IDR, MSP, and 99 99 99 MBL (Fl-score > 97%).
For EDR, the metrics also indicate satisfactory results (Fl-score > 88%).
3.6.
Postprocessing and Prediction on Unlabeled Magnetopause Crossings Data The final model of the neural network is trained using all available data regardless of the sets established before.
The input data are then replaced by unlabeled data points taken from September 2015 to March 2016 corresponding to phase 1a of MMS.
We used the magnetopause crossings database from Paschmann et al.
(2018) to reduce the MMS database to magnetopause crossings of phase 1a and reduce the overall time of computation.
For each data point, the algorithm yields a predicted class and a neuron activation intensity (the highest output value among those of the neurons representing each class) going from 0 to 1 that can be interpreted as a level of confidence of the algorithm, giving lower values when the data point was harder to classify probably because it did not resemble enough data points included in the training database.
The scarcity of EDR training examples was a challenge for this study as explained previously.
The highest precision we achieved for the algorithm is relatively high but when it is applied to the number of data points that we are doing the predictions on, it is normal to find a lot of potential false positives.
This is why we chose some criteria of postprocessing in order to reduce the number of potential EDR cases, leaving the predictions of the other plasma regions untouched.
We chose to only consider the EDR predictions of data points that corresponded to the following criteria: ¢ Neuron activation intensity >0.8: to discard ambiguous predictions.
¢ |B,| < 30 nT: the algorithm tends to mislabel some IDR data points as EDR and we found that it was particularly true for “Separatrix IDR” data points so removing the EDR detections with higher B, would remove some of these cases.
EDRs at the dayside magnetopause should exhibit small B, values since they are supposed to be the center of the current sheet magnetic field reversal.
¢ Electron density n.
> 5 cm: the regions with small number density typically correspond to the magnetosphere.
In these regions, electron distribution functions become less reliable owing to low count detections by FPI and therefore MeanRL becomes unreliable.
Furthermore, the dayside magnetosphere is often populated by cold (a few eV) plasma, which affects E field measurements (Toledo-Redondo et al., 2019).
Therefore, we exclude EDR selections featuring low electron density because of these potential issues.
* MeanRL >2: to increase the likelihood of having well identifiable crescents in the electron velocity distribution functions.
¢ J.E> 1000 pW m ~: to avoid false positives that could also be present in MSPs.
¢ We require a minimum of two consecutive EDR points: the identification of only one data point as EDR is more likely to be a false positive resulting from time aliasing or spurious data points.
After the postprocessing, less than 10% of the detected EDR cases remain.
These postprocessing criteria may remove some real EDR detections in the end, but they significantly reduce the number of false positives and permits manual checking of each remaining candidate.
For example, a new EDR event recently found during phase la and detailed in Zhong et al.
(2020) was detected by our algorithm but removed from our pool of EDR cases to manually check after the postprocessing.
The reason is that we fixed the MeanRL threshold at 2 to limit false positive detections but for this case, the data points radiolabeled as EDR by the algorithm had MeanRL values just below 1.8, thus not making it past the postprocessing step.
9 of 18 fri AGU ADVANCING EARTH AND SPACE SCIENCE Table 2 Earth and Space Science 10.1029/2020EA001530 List of new EDR Candidates Found by the Algorithm.
ID 20150909_084324 20150909_ 125814 20150909_ 142734 20150911_ 101214 20150914_161634 20150919 092544 20150922 134024 20150923 090914 20151001_065214 20151006_141714 20151202_011514 20160102_ 234614 20160107_221104(2) 20160205_ 221924 20160211_015924(2) 20160214_204124(3) 20160219_183904(2) 20160228 _010604(2) EDR time MMS Mean SC separation (km) Jx E(nW m”) MeanRL Label 08:43:58 3 200 5 3 EDR 13:00:22 4 154 1 3.5 EDR 14:28:51 3 145 1 2.6 EDR 10:13:35 3 178 —10/+2 5 EDR 16:17:50 2 139 —10 8.5/2.75 OEDR 09:26:27 3 62 7.5/4 3/1.8; 2.5 EDR 13:41:31 3 51 —6 3.5 OEDR 09:09:38 4 62 —6 4 OEDR 06:53:43 2 51 —5 5 EDR 14:17:54 1 26 1.8 3 EDR 01:17:02 1 18 —4 3.2 OEDR 23:46:17 4 41 —2.1 2.75 OEDR 22:12:20; 22:11:37 3,4 44 5; -—10/+20 2.5: 2,19 EDR 22:19:46 1 14 3 2.25 EDR 02:01:04 1,3 14 1.2; 1 6; 4.8 EDR 20:41:56 2,3,4 15 —4/+5; —1/+1; 10 4.75; 4.3; 5 EDR 18:42:38-39; 18:42:38-40 Le iS W2/2.75; Wey 5 3.1/2:5; 3/25 EDR 01:07:33 1,3 16 4; 7.5 5; 2.4 EDR Two times are given if the time of the EDR signature is different from one spacecraft to another.
Values separated by a slash indicate that they rapidly change from one to another during the EDR signature.
The ID column shows the start time of the burst CDF file containing the EDR candidate.
LENOUVEL ET AL.
4.
New EDR Candidates 4.1.
List of Selected New EDR Candidates After the postprocessing described in Section 3.6, each remaining EDR predictions in the span of a single burst data CDF file was given an ID and manually inspected.
Out of the 137 manually checked events found during the phase 1a of MMS, 18 were selected as new EDR candidates based on the visual inspection of crescents and physical parameters, and we present them in table 2.
To our knowledge, these EDR crossings have not been previously reported.
An extensive exploitation of the full list is not within the framework of this first paper, which focuses on the method.
We separate the candidates into two labels being EDR and outer EDR (OEDR) based on the average sign of J.E over the event, the details of this choice can be found in Section 5.
4.2.
Event Illustration On September 11 2015, at 10:13:35 , MMS3 encountered an EDR candidate event during a magnetopause crossing taking place between T10:12:14.1  and T10:15:24.0 .
The separation of the MMS tetrahedron was large at that time (~200 km) and the other spacecraft did not cross the EDR.
Figure 4 shows the overview of the EDR candidate event crossed by MMS3.
From 10:12:14  to 10:13:10 , MMS was in the MSP, the mean electron density was 0.1 cm7*, the electron temperature was few hundred eV, and the magnetic field intensity B, was high (~50 nT) (see Figures 4a—4c).
At 10:13:12 , we observe a magnetopause crossing with a magnetic field B, reversal, the electron density going from 0.1 cm™~ to 15 cm™*, and a decrease in the electron temperature from hundreds of eV to tens of eV.
MMS3 was then on the magnetosheath side of the magnetopause, as can be seen from the negative B, field and the electron density being slightly higher around 18 cm™, until 10:13:30  when MMS3 encountered first the IDR and then the EDR.
One can see the increase in 10 of 18 Af tI .
Pa \e Le Earth and Space Science 10.1029/2020EA001530 ADVANCING EARTH AND SPACE SCIENCE MMS3 - 20150911_101214 -50 600 —— Teperp 400 Te [eV] 200 0 30 n 20 [cm*] 10 0 E+VixB —— E+VexB 20 Ohm_perp [mV/m] | 0 20000 10000 J.E [pW/m] ° —10000 6 4 MeanRL 10:12:30 10:13:00 10:13:30 10:14:00 Figure 4.
Overview of the EDR candidate event, together with the automatic classification made by our algorithm.
Blue-shadowed regions correspond to magnetosphere data point predictions by the algorithm, mostly characterized by low density and high magnetic field intensity.
Yellow-shadowed regions correspond to IDR/separatrix data point predictions, characterized by large departure from zero for the terms of the generalized Ohm's law as well as nonzero energy dissipation.
Red-shadowed regions correspond to EDR data point predictions characterized by lower magnetic field intensity, high electron temperature gradient, large departure from zero for the terms of the Ohm's law, high energy dissipation and high MeanRL values.
(a) Magnetic field in GSE coordinates.
(b) Parallel and perpendicular electron temperatures.
(c) Electron and ion densities measured by FPI.
(d) Perpendicular to B components of the terms of the Ohm's law.
(e) Energy dissipation, J.E.
(f) MeanRL scalar.
the non-ideal terms of the Ohm's law (Figure 4d) and the large energy dissipation (J.E, Figure 4e).
After 10:13:36, MMS3 goes back into a region of magnetosheath plasma as can be seen by the increase in electron density, the lack of energy dissipation as well as the negative B, component.
In Figure 4, the detection of the EDR by our algorithm is represented by the red vertical line, which is located around 10:13:35 .
Detections of IDR/separatrix region are marked using yellow shadowing, and magnetosphere detections are shadowed in blue.
Figure 5 shows the EDR crossing at a higher time resolution, in the interval T10:13:35.12 -T10:13:35.52 .
The nominal time resolution for electron measurements taken by FPI is 30 ms, but it is possible to obtain moments and distribution functions at a higher cadence, up to 7.5 ms, at the expense of having lower LENOUVEL ET AL.
11 of 18 fri AGU ADVANCING EARTH AND SPACE SCIENCE LENOUVEL ET AL.
Earth and Space Science 10.1029/2020EA001530 spatial resolution (Rager et al., 2018).
We use that technique and present electron measurements at 30 and 7.5 MS.
The LMN coordinates are obtained by applying minimum variance analysis (MVA) to MMS3 B field measurements between 10:13:08 and 10:13:18 , that is, during the magnetopause crossing previous to the EDR.
Applying MVA on MMS1-4 for that time interval yields similar results.
The LMN coordinates used in Figure 5 are L = (0.07; 0.45; 0.89)¢sz, M = (0.54; 0.73; —0.41 )csz, and N = (—0.84; 0.51; —0.2)csz.
We note, however, that MVA applied locally at the EDR observed by MMS3 provides a different LMN coordinate system.
We attribute this LMN indetermination to 3D effects, that is, the reconnection geometry at the tetrahedron scale (~200 km) is not invariant in the M direction.
Figure 5a shows the magnetic field components in LMN coordinates.
At the time of the EDR, we observe a magnetic field minimum B < 6 nT.
Figure 5b corresponds to the non-ideal electric field E’ = E + v, x B, with various peaks >10 mV m7’, indi cating demagnetized electrons at the EDR and its surroundings.
Figure 5c shows the electron velocity in LMN coordinates, indicating electron outflows in the +L direction prior to the EDR, and large outflows in the —N direction at the EDR.
The electron density during the interval (not shown) is 10-15 cm’, this value is similar to the values for the other previously reported EDR cases.
Figure 5d shows energy dissipation (J.E’), with a positive peak of 30 nW m ~ in a region with large electron temperature anisotropy and just before the B minimum.
At the B minimum, J.E' goes negative, although the average J.E’ over the whole EDR crossing is positive.
These fluctuations of J.E’ have been reported in other EDR encounters (e.g., Genestreti et al., 2018).
Figure 5e shows the MeanRL parameter at 30 ms (black) and 7.5 ms (blue) cadence.
Its large values are indicative of perpendicular crescents in the electron velocity distribution function.
The electron velocity distribution functions (eVDFs) in the V,,, V,, are shown in panels 1-9.
eVDFs 4-7 correspond to the EDR region and have the largest MeanRL values, and crescents can be easily identified, characteristic of electron agyrotropy in the EDR.
The crescents in panels 4-7 look incomplete due to the presence of fingers or striations, indicating that the eVDFs are not stationary on the 30-ms sampling period of the electron instrument.
Note that looking at 7.5 ms distribution functions confirms the presence of crescents during this time interval (not shown).
Figure 5f shows the electron differential energy flux and electron temperature throughout the crossing.
Prior to the EDR the electron temperature is of the order of hundred eV and drops to tens of eV after crossing the EDR, indicating that the EDR was in between two different plasma regions.
Large temperature anisotropy (T| > T,) is observed along the interval.
Finally, Figure 5g shows the electron pitch angle distribution for energies 100-1000 eV.
We notice electron demagnetization with an increase in the flux of perpendicular electrons at the EDR, resulting in reduced temperature anisotropy.
In summary, we interpret the observations of Figure 5 as an EDR crossing due to the following observations: a thin current sheet separating two plasma regions with different temperatures, large electron flows, positive J.E’, electron demagnetization, temperature anisotropy and agyrotropy, and electron crescents.
4.3.
Comparison of the New EDR Candidates with the Previously Reported Cases In this section, we compare the new EDR cases presented in Section 4.1 with the 32 previously reported cases listed in Webster et al.
(2018).
In Figure 6, we can see the spatial spread of the new EDR candidates along the MMS orbit, as well as that of the 32 previously reported dayside EDR cases.
We can observe that the distribution of the new EDR candidates is similar to that of previously reported cases during phase 1a but the detections of the algorithm seem to be more located near the flanks.
This could be explained by the fact that MMS spacecraft tend to do relatively faster cuts through the magnetopause around the subsolar point than near the flanks where MMS spacecraft is more often skimming the magnetopause, increasing the time spent in regions likely to contain EDR signatures.
Figure 7 shows a boxplot comparing the distribution of the values of the features of the previously reported EDR and of the new EDR candidates.
We can observe that the values for the new EDR candidates are very 12 of 18 Lh”7~ t ) NW Earth and Space Science 10.1029/2020EA001530 AND SPACE SCIENCE ote _£ LL > E 7) ~~ >” &.
a w & —s = | a axe i) wu = 3 8 at .
7 ra vo © 6° § 5 4g > 9 as Mo ” S 7 4% x T10:13:35.2 T10:13:35.3 T10:13:35.4 T10:13:35.5 2015-09-11  2015- 09-11TT10:13:35.209 26 2015- 09-11TT10:13:35.299 _ 2015- 09-11T10:13:35.
389 27 ;: a7 5 y: 7 ~ 8 7.
8 a 0 = a 0 = a _ ez: iG Qa ww” lon yl > -28 “s > 28 o > 2 Es 8 8 -29 29 earl Vperpi 1 4 2015- 09-11TT10:13:35.239 26 2015- 09-11T10:13:35.
329 2015- 09-11T10:13:35.
419 oy & j % — @ a a ao 0 ~ 7 mT 2 Qa Ph tol Qa a > -28 o ro > ° a ay i) i) -29 Wier 2 2015-09-111:T10:13:35.269 2015-09-117:T10:13:35.359 2015- 09-11T10:13:35.
449 ‘ 2 Pa 2 “, a a a = > > > ve 8 LENOUVEL ET AL.
13 of 18 mMwwvu Earth and Space Science 10.1029/2020EA001530 ADVANCING EARTH AND SPACE SCIENCE Figure 6.
Spatial repartition of the new EDR candidates (red dots), of the other EDR radiolabeled and detections of the algorithm during phase 1a (pink dots), as well as that of the 32 dayside EDR (blue dots) cases previously reported in Webster et al.
(2018) using CDPP’s 3Dview software (Génot et al., 2018) and plotted in GSE coordinates.
Yellow points represent magnetopause crossings during phase 1a of MMS computed from the Shue model (Shue et al., 1997), while white lines show the trajectory of MMS during phase 1a.
different from that of other regions and very close to those for previously reported EDR cases, reinforcing our belief that the cases found by our algorithm and that we then manually selected are EDR candidates.
Note that MeanRL values are all above 2 because of the postprocessing, which explains why the distribution is different from that of Webster's cases.
5.
Discussions We presented a list of 18 new EDR candidates found during the phase 1a of MMS.
In addition to the 32 previously reported cases listed in Webster et al.
(2018) and the more recent EDR candidate propositions (e.g., Xu et al., 2020), it brings the number of identified EDR candidates during the phase 1 to over 50.
This number is close to the 56 EDR encounters that were expected at the dayside magnetopause during the 2.5 years of the nominal mission of MMS (Fuselier et al., 2016) based on the maximum shear reconnection model by Trattner et al.
(2007a, 2007b).
As new dayside EDR candidates found during phase 1 keep being reported, the number of EDRs may well exceed the number of expected EDRs.
One possible explanation to this would be that the size of the EDR may be larger than expected, allowing MMS to do multiple crossings of the same EDR structures.
We said in the previous section that EDRs can be decomposed into an inner EDR region and an outer EDR region, the difference between the two being the overall sign of J.E during the event.
The energy dissipation J.E is a parameter reflecting the energy conversion of the system, a positive value meaning that the magnetic energy is converted into kinetic and thermal energy and a negative value meaning that the energy is transferred from the particle to electromagnetic fields, with positive energy dissipation being the expected behavior at the EDR since the EDR is the place where the breaking of the magnetic field lines occurs, releasing their energy which accelerates surrounding particles.
PIC simulations from Cassak et al.
(2017) and Swisdak et al.
(2018) showed that regions of positive and negative energy dissipation both exist, showing the natural patchiness of the structure of the EDR.
Following studies from Burch et al.
(2018) explain this structure by the combination of oscillating electric fields and oblique quasi-electrostatic whistler waves.
In the 32 previously reported EDR events, 24 events have J.E > 0 (75%), 2 events (A08 and B32) have J.E < 0 (6.25%), and 6 have an oscillating energy dissipation (18.75%).
Treating each spacecraft separately, our complete list of 137 potential EDR candidates identified by the algorithm comprises 195 different magnetopause crossings.
Among these, we count 112 crossings with J.E > 0 (57.44%), 59 crossings with J.E < 0 (30.25%), and 24 crossings with an oscillating J.E (12.31%), meaning the energy dissipation goes from positive to negative or from negative to positive during the same potential EDR crossing.
If we only look at the 18 cases we present in this study which constitutes a number of 24 separate crossings, we get 14 crossings with J.E > 0 (58.33%), 7 crossings with J.E < 0 (29.17%), and 3 crossings with an oscillating energy dissipation (12.5%).
We tried without success to link the positive and negative energy dissipations of our events to the outflow Figure 5.
Close view of the EDR and the associated electron velocity distribution functions.
(a) Magnetic field in LMN coordinates.
(b) Non-ideal electric field E’ = E+ v, XB, in LMN coordinates.
(c) Electron velocity in LMN coordinates.
(d) Energy dissipation (J.E).
(e) MeanRL scalar, red-shadowed region correspond to the algorithm's EDR detection, yellow-shadowed region corresponds to the algorithm's IDR detection.
(f) Electron differential energy flux (color), parallel electron temperature (white), and perpendicular electron temperature (blue).
Blue vertical bars correspond to the central times of the velocity distribution functions plotted below (1-9).
(g) Electron pitch angle distributions for electrons with energies 100-1000 eV.
(1-9) Individual electron velocity distribution function cuts in the perpendicular to B plane, sampled at 30 ms, associated to the vertical blue bars in panels (g) and (f).
LENOUVEL ET AL.
14 of 18 fri AGU ADVANCING EARTH AND SPACE SCIENCE Bz [nT] 60 NewEDR WebsterEDR Earth and Space Science 10.1029/2020EA001530 |(ixB)_Pe| [mV/m] |(E+VexB)_ Pe] [mV/m] |(E+VexB)_ Pe] [mV/m] |J.E] [pW/m*3] |J_Pe] [nA/m*2] MeanRL ° ° 30000 2000 8 25000 30 ° ° 8 25 20000 1000 é 8 ° 20 ° ° 15000 0 15 10000 10 —1000 5000 5 ° 0 (¢) ° —2000 NewEDR WebsterEDR NewEDR WebsterEDR NewEDR WebsterEDR NewEDR WebsterEDR NewEDR WebsterEDR NewEDR WebsterEDR NewEDR WebsterEDR Figure 7.
Boxplots showing for each physical parameter the distribution of the values for the 18 selected new EDR candidates and for the 32 dayside EDR events previously reported in Webster et al.
(2018).
Each rectangle contains 50% of the values of the distribution; the line inside a rectangle represents the median of the distribution.
Black circles are outliers of the distribution, they are defined by being below the threshold Q; — 1.5 x (Q3 — Q;) or above the threshold Q; + 1.5 X (Q3 — Q,) with Q; and Q; being the first and third quartiles.
LENOUVEL ET AL.
criterion for being in the inner EDR given by Cozzani et al.
(2019), which is (V4; < Vo; < V4), with V., the L coordinate of the electron velocity, V,; the Alfvén velocity of the ions, and V,, the Alfvén velocity of the electrons.
The main problem is that the electron speed in our cases is always far lower than the Alfvén velocity of the electrons and it is sometimes even lower than the Alfvén velocity of the ions, making it impossible to meet the criteria for the outer EDR.
The determination of the inner/outer limit of the EDR is probably too complex to be assessed using a single criterion on the electron jet velocity.
Geometric considerations (intrinsically 3D picture, guide field, etc.) may be at work and cannot be captured efficiently by the localized nature of the electron jets.
The algorithm that we use has a few limitations, the first one being that it does not make use of the context of the magnetopause crossing, only afterward using post processing parameters.
Detections are made time step by time step and in plasma regions where the different plasma parameters change rapidly, classifications are sometimes noisy.
This is not ideal, especially in the case of EDR detections where every detection on a time step is relevant, and it is a source of false positives that needs to be taken care of.
The second limitation is that our method heavily relies on the presence of crescents in the electron velocity distribution functions to identify EDRs since our training dataset is based on the list from Webster et al.
(2018), which had EDR crescents as main criteria of selection.
Yet, crescents similar to EDR ones can be found in other plasma regions due to pressure gradients.
Another problem is that EDR crescents are not visible during events with large guide fields, indeed our algorithm did not pick up a new EDR case with a high guide field found during phase 1a of MMS and reported by Xu et al.
(2020), all these limitations of the algorithm will the basis for more refined algorithms in the future.
6.
Conclusion We presented a list of 18 new magnetic reconnection EDR candidates that were identified in the MMS phase 1a data using a neural network algorithm trained on the 32 dayside EDR cases previously reported by Webster et al.
(2018).
The physical properties of the new candidates are in accordance with those of the previously reported EDR cases.
We also presented in some details one of the new EDR candidates found on September 11 2015, using our algorithm.
The detection of new EDR candidates is strongly based on the 15 0f 18 fri AGU ADVANCING EARTH AND SPACE SCIENCE Acknowledgments This work was supported by the French space agency CNES.
The authors acknowledge the support of the MMS instrument and science teams.
We thank E.
Penou for his technical support on the handling of MMS data at IRAP.
We also acknowledge support of the ISSI international teams “Cold plasma of ionospheric origin in the Earth's magnetosphere” and “Study of the Physical Processes in Magnetopause and Magnetosheath Current Sheets Using a Large MMS Database.” S.
Toledo-Redondo acknowledges support of the Ministry of Economy and Competitiviness (MINECO), Spain (Grant No.
FIS20:17 - 90:102-R).
This research made use of Keras (https://keras.io/) to develop the machine learning code.
LENOUVEL ET AL.
Earth and Space Science 10.1029/2020EA001530 presence of crescents in the electron velocity distribution functions denoting electron agyrotropy, as well as on other EDR characteristics like high energy dissipation and electron demagnetization.
The identification of these crescents in the time series of MMS was enabled by the use of a scalar quantity called “MeanRL,” capturing the asymmetry of the electron velocity distribution functions in the plane perpendicular to the magnetic field.
Among the new EDR candidates presented in this study, 40% show either negative or oscillating energy dissipation underlining the patchy structure of the EDR with a possible distinction between inner and outer EDRs.
Future work is needed to enhance the efficiency of detections of EDRs, and special attention will be brought to reduce the number of false positives.
This will be achieved by improving the architecture of the algorithm by using more refined machine learning architectures, by improving the detection of electron velocity distribution crescents in the data, and by refining the parameters used as inputs, which is out of the scope of the present paper.
An analysis of all dayside magnetopause MMS data would also allow to detect more EDR candidates, enabling larger statistical analysis and a better understanding of the physical properties of magnetic reconnection.
Appendix: Machine Learning Algorithm’'s Architecture The algorithm we used is a classical feed-forward Multilayer Perceptron.
It was developed using Keras/ Tensorflow in Python and trained using a “categorical crossentropy” type loss function with the “Adam” optimizer (Kingma & Ba, 2014).
The loss function is the function used to compute the error made by the algorithm during the training, leading to the update of the weights in order to reduce the error on the next iterations.
The optimizer dictates the way to minimize the loss function, usually it is done by making steps in the hyperparameter space that follow the biggest gradient.
We also used a number of Epochs of 60 and a batch size of 128, the number of Epochs being the number of times the algorithm will iterate over the full training dataset and the batch size being the number of data points read before actualizing the weights in the neural network.
Our best combination of hyperparameters has been determined through trial and error combined with Bayesian optimization techniques (Wu et al., 2019), though our tests suggested that the hyperparameter space of our algorithm was rather flat as different combinations of hyperparameters were giving results with similar metrics in the end.
The architecture of the final model (which is the model trained using all of the available data) is an input layer of 17 neurons, then a first hidden layer of 17 neurons with a “ReLU” activation function followed by a second hidden layer of 33 neurons with a “tanh” activation function, and finally an output layer of 4 neurons corresponding to the 4 classes we are trying to identify with a “softmax” activation function which is the standard practice for classification tasks in machine learning.
Data Availability Statement MMS data used in this article are publicly available for free at the MMS science data center and downloadable at https://lasp.colorado.edu/mms/sdc/public/datasets/ and MMS data rights and rules are detailed at https://lasp.colorado.edu/mms/sdc/public/about/.
.
