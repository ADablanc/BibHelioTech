Space Weather’

RESEARCH ARTICLE
10.1029/2021SW002969

Key Points:

e We present a short-time prediction
of the electron flux in the planetary
radiation belt based on five different
machine learning methods

e We compared the electron flux
predictions from 30 keV to 4 MeV
and all five models can present valid
short-time flux forecasts

e Further experiments on Saturn also
show the validation of the ensemble
model

Supporting Information:

Supporting Information may be found in
the online version of this article.

Correspondence to:

Z. Chen,
chenzhou @ncu.edu.cn

Citation:

Tang, R., Tao, Y., Li, J., Chen, Z., Deng,
X., & Li, H. (2022). The short-time
prediction of the energetic electron flux
in the planetary radiation belt based on
stacking ensemble-learning algorithm.
Space Weather, 20, e2021SW002969.
https://doi.org/10.1029/2021SW002969

Received 29 OCT 2021
Accepted 20 JAN 2022

Author Contributions:

Conceptualization: Rongxin Tang
Formal analysis: Rongxin Tang, Yuhao
Tao, Jiahao Li, Zhou Chen, Xiaohua
Deng, Haimeng Li

Investigation: Rongxin Tang, Yuhao Tao,
Jiahao Li, Zhou Chen, Haimeng Li
Methodology: Rongxin Tang

Project Administration: Xiaohua Deng
Software: Rongxin Tang, Yuhao Tao,
Jiahao Li, Zhou Chen

Supervision: Rongxin Tang, Xiaohua
Deng

Validation: Rongxin Tang, Yuhao Tao,
Jiahao Li, Zhou Chen, Xiaohua Deng

© 2022. The Authors.

This is an open access article under

the terms of the Creative Commons
Attribution-NonCommercial-NoDerivs
License, which permits use and
distribution in any medium, provided the
original work is properly cited, the use is
non-commercial and no modifications or
adaptations are made.

TANG ET AL.

® Check for updates

Ah = a il ADVANCING
PAIS space science

ni}

The Short-Time Prediction of the Energetic Electron Flux in
the Planetary Radiation Belt Based on Stacking EnsembleLearning Algorithm

Rongxin Tang!3 ©, Yuhao Tao!”, Jiahao Li2, Zhou Chen!” ©, Xiaohua Deng! ©, and Haimeng Li! ©

"Institute of Space Science and Technology, Nanchang University, Nanchang, China, *School of Information and Engineering,
Nanchang University, Nanchang, China, “Jiangxi Provincial Key Laboratory of Interdisciplinary Science, Nanchang
University, Nanchang, China

Abstract High energy electrons in planetary radiation belts are a major threat to satellites and
communications in deep space applications. In order to predict the variations of energetic electron fluxes for
different energy channels, we proposed a new ensemble machine leaning model for differential electron flux
from 30 keV to 4 MeV in the Earth's radiation belts based on the RBSP-A observation data from March 2013 to
December 2017. The deep neural network (DNN), the convolutional neural network (CNN), the combination of
CNN and DNN (CNN&DNN), the linear regression (LR), and the light gradient boosting machine (LightGBM)
are among the machine learning models chosen. We carefully compared the electron flux predictions for 20
energy levels and all five models can present valid short-time flux forecasts. The DNN model has the poorest
result. The LR model is good for short-term forecasting but not so good for long-term forecasting. The
LightGBM ensemble model is highly stable, and it has always outperformed other independent models in terms
of forecast accuracy. Then the comparison by adding AE and SYM-H indexes is given and the influence of
geomagnetic activity conditions can be negligible for this short-time prediction. Furthermore, we applied these
five models on Saturn and finally got very similar prediction results. Our results will be significantly useful in
instrument designs and system control of future scientific satellites in deep space explorations.

Plain Language Summary With the development of AI hardware technology, it can be predicted
that those smart chips will soon be applied to various observation instruments carried by space exploration
satellites. However, based on the requirements of energy limits and physical dimensions in satellites, the

smart chips used in the instruments can not have very powerful computing power, which may not be effective
for current long-time space weather predictions with many large-scale parameters. In the present study, we
present a short-time electron flux forecast in planetary radiation belts whose experiments only consider the
historical flux data and local parameters. We used five different machine learning models to give the short-time
prediction of the electron differential fluxes for all 20 energy levels from tens of keV to several MeV based

on RBSP-A observations. We also verified this ensemble model on the electron flux forecast near Saturn's
equatorial plane by using CASSINI/MIMI data. Our work give a new insight in the space weather applications
based on machine learning, which will be critical for practical applications to the instrument designs and system
operations of new scientific satellites in the space radiation environment.

1. Introduction

Radiation belts have been observed at many magnetized planets in the solar system, such as Earth (Summers
et al., 2009), Jupiter (Bolton et al., 2004) and Saturn (Carbary et al., 2009). Understanding the transport, acceleration and loss of radiation belt electrons is a major research topic in planetary magnetospheric physics (Tang
& Summers, 2012; Tang et al., 2014) since these energetic electrons pose a potential hazard to orbiting satellites.
Previously, the observational data being gathered by numerous satellites were incorporated into simulation models of the radiation belt (Ni et al., 2019), which remain widely used for spacecraft design purposes and space
environment predictions. However, the practical space weather applications also require innovative approaches
to the use of mass satellite data, and will lead to further advances in the research of planetary radiation belts (Ni
et al., 2009).

With the continuous development of artificial intelligence technology, scientists began to explore the applications of machine learning in space physics, such as the stellar atmospheric parameter (Ramirez et al., 2001),

1 of 17
vrij
rid
ADVANCING EARTH
AND SPACE SCIENCE

Visualization: Rongxin Tang, Yuhao
Tao, Jiahao Li, Zhou Chen, Haimeng Li

Writing — original draft: Rongxin Tang,

Yuhao Tao, Jiahao Li, Zhou Chen
Writing — review & editing: Rongxin
Tang, Zhou Chen

TANG ET AL.

Space Weather 10.1029/2021SW002969

solar activity (He et al., 2008), space weather forecast (Bala et al., 2009), global TEC map (Z. Chen et al., 2019),
and solar flare predictions (Tang, Zeng, et al., 2021, Tang, Liao et al., 2021) etc. Recently, neural network has
gradually been applied to solve these problems. Myagkova et al. (2017) established a neural network model to
reconstruct the global distribution of cold plasma density by combining the solar wind data and geomagnetic index. Lethy et al. (2018) used the artificial neural network (ANN) to predict the changes in the DST index over the
next 1-12 hr. Shprits et al. (2019) used historical and real-time K, data to obtain the trend of future K, prediction.
Xu et al. (2020) presented an ensemble learning model by combining artificial neural network, support vector
regression, and long short-term memory network to predict the DST parameter with higher accuracy.

As for the radiation belts, Koons and Gorney (1991) introduced a neural network to predict electron flux in geosynchronous orbit by using K, index. Ukhorskty et al. (2004) used the relevant parameters of the solar wind to
predict the high-energy electron flux in geosynchronous orbit. Ling et al. (2010) presented a multi-layer feedforward neural network model, to achieve the relativistic electron flux forecasting in geosynchronous orbit by using
the historical electron flux values for 10 consecutive days and the summations of the planetary K, exponents for
seven consecutive days. Based on the support vector machine model in machine learning, Myagkova et al. (2017)
explored the possibility of the time series prediction of relativistic electron flux in the Earth's outer radiation
belt using the solar wind parameters measured at vibration points, the interplanetary magnetic field and the
geomagnetic index. Y. Chen et al. (2019) designed a new model, called PREMEVE, to reliably predict the time
distribution of relativistic electron storms in the outer radiation belt. Then, Pires de Lima et al. (2020) added machine learning algorithms to this model, namely PREMEVE2.0, to provide better forecasting results, especially in
larger L-shells. The linear regression model tends to have better performance when L > 4.5. Smirnov et al. (2020)
predicted the electron flux for the medium energy (120-600 keV) based on satellite position, geomagnetic index
and solar wind parameters (including velocity time history). Chu et al. (2021) used a neural network (ANN) to
build a relativistic electron model for the prediction of the Earth's outer radiation belt.

However, it should be noted that those previous works mainly concentrated on the electron flux or space weather
predictions of some large-scale physical parameters for a relatively long-time period. We understand that the
space environment is very complicated and associated with so many conditions. With the development of AI
hardware technology, the deep learning algorithms embedded in FPGA or other microchips have been studied
and begun to be used in mobile phones, intelligent robots, self-driving cars, and so on. It can be predicted that
those smart chips will soon be applied to various observation instruments carried by space exploration satellites.
On the other hand, based on the requirements of energy limits and physical dimensions in satellites, the smart
chips used in the instruments can not have very powerful computing power, which may not be effective for current long-time space weather predictions with many large-scale parameters. Therefore, in the present study, we
try to present a short-time electron flux forecast in planetary radiation belts whose experiments only consider
the historical flux data and local parameters, such as L, MLT and MLAT. By using the RBSP-A/MAGEIS data
during March 2013—December 2017, we used five different machine learning models, including the deep neural
network (DNN), the convolutional neural network (CNN), the combination of CNN and DNN (CNN&DNN), the
linear regression (LR), and the ensemble model of above four models by using light gradient boosting machine
(LightGBM), to give the short-time prediction of the electron differential fluxes for all 20 energy levels from
tens of keV to several MeV. The prediction performances and corresponding errors were detailedly compared
and discussed. We also simply tested the effects of AE and SYM-H indexes on the LightGBM ensemble model
to prove that the short-time prediction only with local parameters are effective and better than these predictions
with AE and SYM-H. Furthermore, we verified this ensemble model on the electron flux forecast near Saturn's
equatorial plane by using CASSINI/MIMI data. Our work give a new insight in the space weather applications
based on machine learning, which will be critical for practical applications to the instrument designs and system
operations of new scientific satellites in the space radiation environment.

The rest of this paper is organized as follows: In Section 2 we introduce the models and data of Earth. In Section 3
we present the corresponding experimental results. In Section 4, we apply the models to Saturn and carry out
relevant experiments. The conclusions will be summarized in Section 5.

2 of 17
vrij
rid
ADVANCING EARTH
AND SPACE SCIENCE

TANG ET AL.

Space Weather 10.1029/2021SW002969

RBSP-A input —_ prediction

Data sampling

30samples 60 samples
eM
MagEIS data 30samples | 120 samples

a ee i Se a
Bes Wane Smin 0 7.510 15 20min
(a)
===> Training process DNN DNN Prediction
=m Testing Process CNN CNN Prediction
Train Data CNN = = DNN Union Prediction
Test Data LR LR Prediction

Ensemble Prediction

LightGBM
(b)

Figure 1. Data sampling and the training process with testing procedure of five models.

2. Electron Flux Data and Machine Learning Models
2.1. Electron Flux Data

In our study, using the observations of Van Allen Probe A, we first performed the electron flux predictions in the
Earth's outer radiation belt. The perigee of Van Allen Probe is ~1.1 R,, (radius of the Earth), and its apogee is ~6.2
R,,. The L-shell that we concentrated on is around 3.7 ~ 7.2, which mainly covers the Earth's outer radiation belt.
The observational electron flux data with a 10 s time resolution are provided by the Magnetic Electron Ion Spectrometer (MagEIS) level-2 data sets of Van Allen Probe A (Blake et al., 2013). Its Z-shell values were mainly calculated from the McIlwain's method (MclIlwain, 1961). The time period is from 31 March 2013 to 31 December
2017, which almost covers three satellite operation cycles. All 20 energy levels, including 31.5, 53.8, 79.8, 108.3,
143.5, 183.4, 226.1, 231.8, 342.1, 464.4, 593, 741.6, 901.8, 1077.7, 1547, 1701, 2275, 2651, 3681, and 4216 keV,
are finally used in the experiments. Furthermore, geomagnetic activity conditions (AE and SYM-H) were added
to compare with the above experiments only with local L, MLT. In order to verify our idea in other planetary
radiation belts, we also used the Low Energy Magnetospheric Measurement System (LEMMS) data set of Cassini
in Saturn's magnetosphere. LEMMS can detect lower energy electrons (18-832 keV) with the CO-C7 channels
and higher energy electrons (0.1—21 MeV) with the EO-E7 channels (Krimigis et al., 2004; Krupp et al., 2009).

It is well known that the data sampling and selection play a crucial role in the whole deep learning prediction
model because the neural network is sensitive to those abnormal values. The following three points must be ensured: (a) the L-shell value cannot be NaN; (b) the L-shell value of two adjacent data points are not too far; (c)
L-shell value will not fluctuate greatly, which means that adjacent L values should be within an interval. In our
study, the difference between selected adjacent L values is less than 0.01. In order to avoid adding dirty data into
the experiments, all data including any NaN in 20 energy levels are all removed. Finally, 9698 819 valid electron
flux data samples from original MagEIS instrument have been selected. Based on all valid independent data
samples, we have carefully divided into several packages for different time interval of short-time flux predictions.
Figure | gives the basic idea of our organizations. First, we should make sure that continuous 30 data samples
are prepared as the historical flux data to obtain the prediction results, which is almost 300 s long. Second, the
electron flux forecasts at the following N = 45, 60, 90, and 120 time steps will be predicted based on the those
historical 30 data samples, which roughly correspond to 7.5 ~ 20 min backwards. Therefore, according to the
above scenario, we cut all 9698 819 into different 30 + N data sets, as shown in Figure la. Third, as for the proportion of training set and test set in flux predictions, the experiment data will be chosen as 80%:20%. Table 1 gives
the specific number of the training and test sets with their time ranges, respectively. It should be noted that all
= (Flux,,, — Flux,,.,)/
) at each energy level, where Flux,,,, is the original flux to be normalized, and Flux... and Flux

observed electron differential fluxes have been normalized by using the formula Flux,
(FLUX ax — Flux

min min

are the maximum and minimum values at this energy level, respectively. The normalization process can make

3 of 17
fri
AGU

ADVANCING EARTH
AND SPACE SCIENCE

TANG ET AL.

Space Weather

10.1029/2021SW002969

The Details of Data Sets and Time Ranges From RBSP-A Satellite

N=45 N= 60 N=90 N= 120
Total data numbers 98477 80894 58778 45545
Training data numbers 78781 64715 47022 36346
Test data numbers 19696 16179 11756 9109
Training time start 2013/03/31 2013/03/31 2013/03/31 2013/03/31
Training time end 2017/01/23 2017/01/23 2017/01/25 2017/01/27
Test time start 2017/01/23 2017/01/23 2017/01/25 2017/01/27
Test time end 2017/12/31 2017/12/31 2017/12/31 2017/12/31

sure all data fall into the interval [0, 1], so that faster convergence speed will be obtained during training process
in following machine learning algorithms.

2.2. Machine Learning Models

The models used in this paper include the DNN, the CNN, the combination of CNN and DNN (CNN&DNN),
the LR, and the ensemble model of above four models by using the light gradient boosting machine (LightGBM)
method.

As for the DNN (Cichy and Kaiser, 2019), the neural network is an extension based on perception. Its hierarchical
structure can be generally divided into input layer, hidden layer and output layer. Hidden layer is used to extract
deep-seated feature information. The deep neural network can be understood as a neural network with many hidden layers, which is also called a multilayer perception.

The second model is the CNN (LeCun et al., 2015) which is different from the deep neural network since its function is responsible for local feature extraction. For the hierarchical structure, its hidden layer generally uses the
convolutional layer and the pooling layer, so that the convolutional neural network can adopt the local-connection
structure between layers.

Theoretically speaking, the convolutional neural network is a subset of the deep neural network. All the solutions
obtained through the convolutional neural network can form a solution of the deep neural network by filling
the weight parameters to 0. Therefore, the deep neural network is superior to the convolutional neural network.
However, under the influence of computational power and algorithms in many cases, the result of convolutional
neural network is superior to that of deep neural network. This is also the reason why the two kinds of neural
networks are used at the same time in this experiment in order to compare the effect of the two networks in this
experiment. In such a case, for the third model we use the combination of the CNN&DNN to check the prediction
performances when the two models are jointed. The data are processed by the CNN model first, and then the
results obtained by the CNN model are input into the DNN model to obtain the final prediction.

The fourth model is a classical LR model (Yu & Yao, 2017) used in machine learning. Linear regression model
is the simplest and most practical prediction model in machine learning. Its principle is based on the correlation
between the independent variable X and the dependent variable Y, which can establish the linear regression equation of X and Y to predict the result.

The fifth model is the LightGBM ensemble model (Kadiyala & Kumar, 2018). LightGBM is based on the classic decision tree model, which was proposed by Microsoft. The main purpose of LightGBM 1s to solve the problem of the
slow speed of decision trees when facing large amounts of data. As the name suggests, LightGBM 1s a lightweight
gradient elevator. Compared with XGBoost model (Wang et al., 2020), it has the characteristics of fast training speed
and low memory consumption, which is nearly 10 times faster than XGBoost and only uses about 1/6 as much memory as XGBoost. The lightGBM has improved the accuracy as well. The working principle of LightGBM is to discrete continuous floating-point features into k discrete values and construct histogram of width k. The training data
are traversed to calculate the cumulative statistics of each discrete value in the histogram. In the feature selections,
it only needs to traverse to find the optimal segmentation point according to the discrete value of the histogram.

4 of 17
vrij
rid
ADVANCING EARTH
AND SPACE SCIENCE

TANG ET AL.

Space Weather 10.1029/2021SW002969

Figure 1b gives the details of the training and test processes of all five models in our work. The LightGBM model
only needs to use the joint model of DNN, CNN, CNN&DNN and LR to forecast the training data respectively,
and then put the predicted results of the four participants to train LightGBM. In the test stage, we can directly
input those data to be predicted, and finally obtain prediction results of the LightGBM without going through the
previous four models.

3. Experimental Results in Earth's Outer Radiation Belt

In order to show the overall prediction effect of above models, Figure 2 gives both observational and predicted
electron differential fluxes along the electron energy during a geomagnetic storm from 26 March 2017 to 29
March 2017. Figure 2a shows the variations of DST index with | hour resolution and AE index with | minute resolution from Wind satellite observation. According to the peaks or troughs of DST and AE parameters, we then
select 12 time points (marked by the red vertical lines) during this period to check the predictions of five models
on the electron differential flux. Figure 2b—2m present the comparisons between observational data (dotted line)
and five predictions from DNN (purple), CNN (yellow), CNN&DNN (green), LR (pink) and LightGBM ensemble (blue) models, respectively, for these 12 time points. All 20 energy levels are included and the prediction time
goes for VN = 60 time steps (10 min). After normalized restoration and log processing, the data are displayed in the
graphs. Generally, the prediction effects of these models are good. Every model can present effective short-time
forecast for the electron differential flux. Both DST and AE indexes have little influence on the prediction results.
However, it can be seen that, in several energy channel of few cases, some models have large deviations from the
predicted value. But the LightGBM ensemble model still has smallest deviations and presents best performances.
It should be noted that since the flux value of the predicted energy level of some models is less than zero, there
iS no corresponding value in the figure after it is deleted in the log procession. We found that this situation will
not occur in the LightGBM ensemble model, which proves the superiority of LightGBM ensemble model again.

When we detailedly compare the differences between the real observations and the prediction results, Figure 3
shows the time-dependent predictions of two selected energy channels (53.8 and 2651 keV) based on five models
during August 04 ~17, 2017, where the panels from top to bottom are outcomes of LightGBM ensemble, LR,
CNN&DNN, CNN, and DNN models, respectively. Here the electron differential fluxes have been normalized
where the blue line represents the real observational data, the red line represents the predicted flux by each model,
and the black dotted line represents the case when the normalized flux equals to zero. It can be clearly seen that,
the predicted fluxes are significantly consistent with the real data. Although the predicted results for those peaks
of electron flux are slightly smaller than the true observations, all five models can still achieve very good forecasting effects according to the time variation. Moreover, it should be noted that, except for the LightGBM ensemble
model, the other four models may obtain several negative values. The reason is that the true electron flux is too
small in the entire energy level, and after normalization, its value is very close to the critical value zero. Therefore, there may be cross-border phenomenon in the process of prediction, that is, it is less than zero. We also give
the similar prediction results of other four energy channels in the Supporting Information S1 to show more cases.

Furthermore, Figure 4 presents the detailed comparisons of prediction results with all observed flux data at
231.8 keV energy channel for different time step when N = 120. The rows from top to bottom are results from
the LightGBM ensemble, LR, CNN&DNN, CNN, and DNN models respectively, while the columns from left to
right give the predictions at the Ist (10th second), 30th (Sth minute), 60th (10th minute), 90th (15th minute) and
120th (20th minute) time step, respectively. Here the x-axis is the normalized true observation flux, the y-axis is
the normalized prediction value, and the red line is the line of y = x. The correlation coefficient (CC) is calculated
from the Pearson correlation coefficient formula

Diet (Xi 7 Xx) (¥; 7 Y)
SS —————— (1)

V dizi (xX; — x)’ V di=i (¥; 7 ry

which can determine whether two data sets are on the same line or measure the linear relationship between two
distance variables. Generally, if the absolute value of the Pearson correlation coefficient is larger, the predicted
electron flux is much closer to the observed data. On the other hand, the root mean square error (RMSE) is also
used here to show the differences between the predicted value and the observed values in these experiments,

5 of 17
Avni |
rid
ADVANCING EARTH
AND SPACE SCIENCE

TANG ET AL.

logioFESA(cm~?s~—tsr—tkeV~?*)

logioFESA(cm~—2s~—tsr—tkevV—1)

logiopFESA(cm~—2s~—tsr—tkeV—?)

logioFESA(cm~—2s—tsr—tkev—1)

Space Weather

2017-03-26

L: 4.546
MLT: 20.707
Time: 2017-03-26 12:24

L: 3.976
MLT: 21.124
Time: 2017-03-27 14:54

L: 5.969
MLT: 21.556
Time: 2017-03-28 03:05

L: 5.833
MLT: 22.067
Time: 2017-03-29 04:50

2017-03-27

25 3
logipEnergy
CNN&DNN ces

(d) (e) (6 (g)

(h) (i)

2017-03-28

L: 6.034
MLT: 20.846
Time: 2017-03-27 00:05

L: 6.133
MLT: 21.264
Time: 2017-03-27 18:08

L: 5.479
MLT: 21.715
Time: 2017-03-28 09:54

L: 5.599
MLT: 22.266
; Time: 2017-03-29 12:55
35 1.5 2 25 3
logigEnergy

RMSE =

ye, (Xi -— Ni
——_—

ad

10.1029/2021SW002969

G) (k)

~~
——_

2017-03-29

L: 6.277
MLT: 20.985
Time: 2017-03-27 08:47

L: 5.036
MLT: 21.407
Time: 2017-03-27 20:09

L: 6.053
MLT: 21.884
Time: 2017-03-28 20:56

L: 5.761
MLT: 22.485
Time: 2017-03-29 22:27

2
lsd Z

ENSEMBLE ==

(I)

25
logipEnergy

True =@==

(m)

-80
2017-03-30

30

Figure 2. Observation of AE and DST parameters during geomagnetic storms and electron flux predicted by five models.

(2)

6 of 17
fri
AGU

ADVANCING EARTH
AND SPACE SCIENCE

0.
0.
0.
0.
0.
0

ormalized Differentied Electom Number Flux

Z 0.6

2017-08-04

2017-08-04

Space Weather 10.1029/2021SW002969
53.8 keV 2651.0 keV

w= Normalized Observational Flux

=—— Predicted Flux jaa
—
jaa
>
jaa
Ny
Z.
1)

2017-08-10 2017-08-14 2017-08-17 2017-08-04 2017-08-07 2017-08-10 2017-08-14 2017-08-17

=== Normalized Observational Flux
—— Predicted Flux

2017-08-10 2017-08-14 2017-08-17 2017-08-04 2017-08-07 2017-08-10 2017-08-14 2017-08-17

m= Normalized Observational Flux
—— Predicted Flux

CNN&DNN

2017-08-10 2017-08-14 2017-08-17 2017-08-04 2017-08-07 2017-08-10 2017-08-14 2017-08-17

wea Normalized Observational Flux
—— Predicted Flux

2017-08-10 2017-08-14 2017-08-17 2017-08-04 2017-08-07 2017-08-10 2017-08-14 2017-08-17

wee Normalized Observational Flux
—— Predicted Flux

2017-08-04

2017-08-10 2017-08-14 2017-08-17 2017-08-04 2017-08-07 2017-08-10 2017-08-14 2017-08-17
Time Time

Figure 3. The comparison of observed Earth's electron flux with predictions of five models at two energy channels over the same period of time.

TANG ET AL.

it can be seen that, at 231.8 keV, most of data points are still close to the red line, especially for those lower electron differential fluxes. All Pearson correlation coefficients are larger than 0.91 and corresponding RMSE values
are smaller than 0.05. It proves that all five models can obtain good forecasting performances. On the other hand,
if we check the results from left to right for each model, the predicted electron flux data from all five machine
learning models deviate from the red line more and more when the prediction time step is extended from Ist to
120th, which has also been confirmed by both the increase of CC value and the decrease of RMSE value. It suggests that the forecasting performance becomes worse when the prediction time step grows up, and is consistent
with the general concept of artificial intelligence applications. Moreover, if we compare the model results from
top to bottom, the prediction of LR model is the best at the beginning, while the CNN&DNN model has slightly poor effect. DNN model has the most scattered points and its performance should be the worst. Finally, the
LightGBM ensemble model does combine the advantages of other models and can achieve the best performance.

Figure 5 shows the variations of the accumulated RMSE value of the prediction data from all 20 energy channels
depending on the prediction time step, for different prediction period, says N = 45 (7.5 min), 60 (10 min), 90
(15 min) and 120 (20 min) time steps. The colors correspond to the LightGBM (blue), LR (pink), CNN&DNN

7 of 17
[Velen
Pa\e TS Space Weather 10.1029/2021SW002969

ADVANCING EARTH
AND SPACE SCIENCE

Step 1 Step 30 Step 60 Step 90 Step 120
10th second 5th minute 10th minute 15th minute 20th minute

ENSEMBLE

CC:0.9995 CC:0.9942 ' ’ ** *CC:0.9834
RMSE:0.0037 ‘ RMSE:0.0115 va RMSE:0.019

0 02 04 06 08 OO O02 04 06 08 O O02 04 06 0.8
0.8 0.8

0 O02 04 06 0.8

CC:0.9999 f CC;0.994 } ° °CC:0.9829
RMSE:0.0017 RMSE:0.0116 # * RMSE:0.0192

0 02 04 06 08 O O02 04 06 08 OO O02 04 06 0.8
0.8 0.8

CC:0.9894 | eS 6CC:0.979 Wee" — “GC-0.9633

CC:0.9949
RMSE:0.0153 ” &- RMSE:0.0213 e _*RMSE:0.028

RMSE:0.0108
02 04 06 0.8
0.8

0 0

Normalized Preditctional FLux

%

CC:0.9987 : CC:0,9914 ee $CC:0.9775 C3 C0.9581 r wes $C040.9387
4 e % :U. 2

RMSE:0.0055 RMSE:0.0138 9 RMSE:0.0221 RMSE:0.036

0 02 04 0.6 8 0 O02 04 0.6 ae 0 02 04 06 08 0 02 04 0.6 oe as 0 02 04 06 0.8

CC:0.9968 CC:0.9877 A 0.9629 ; ¢ R474
RMSE:0.0085 a RMSE:0.0166 nik e *RMSE:0.0336

0 02 04 06 08 O 02 04 06 08 O 02 04 06 08 O 02 04 06 08 0 02 04 06 08
Normalized Observational Flux

Figure 4. The deviation, root mean square error and correlation coefficient of the five models compared with observations of Earth's electron flux under different
prediction scales.

(green), CNN (yellow) and DNN (purple) model, respectively. Generally, the accumulated RMSE value of each
model increases when the prediction time step grows up, which is also consistent with the results of comparisons
within rows in Figure 4. At the beginning, the LR model has the smallest RMSE value, the LightGBM ensemble
model and the CNN model are similar, and the CNN&DNN model obtains the largest RMSE. However, when the
prediction time step increases, the CNN&DNN model gradually gets better and the LightGBM ensemble model
quickly achieves the best forecasting performance. This clearly suggests that the combination of two or more deep
learning models may significantly improve the prediction performance of the electron differential flux, especially
when the scientists want to obtain a relatively long-time prediction.

On the other hand, as for the differences of the prediction results at different energy channels, Figure 6 gives
the variations of the accumulated RMSE value of the prediction data depending on the electron energy for those
five models, where the same colors are used to represent the models like Figure 5. It can be noted that all five
models have similar fluctuations in prediction performance but the LightGBM ensemble model generally has the
best forecasting results. When the total prediction time increases, the RMSE of all energy level also increases,
which is consistent with Figures 4 and 5. However, For 79.8, 464.4, 593, 741.6, 901.8, 1701, 2275, and 2651 keV,
the accumulated RMSE of each model is relatively large. For 183.4, 226.1, and 231.8 keV, the RMSE of the

TANG ET AL. 8 of 17
ADVANCING EARTH
AND SPACE SCIENCE

0.05

0.04

CNN&DNN
DNN

CNN

LR
ENSEMBLE

2nd minnute

CNN&DNN
DNN

CNN

LR
ENSEMBLE

4th minnute

Space Weather 10.1029/2021SW002969

w= CNN&DNN
w= DNN

== CNN

oe TR

w= ENSEMBLE

45 time steps i —~ — ae 60 time steps
(7.5 minutes) (10 minutes)

4th minnute 6th minnute 0 2nd minnute 6th minnute 10th minnute

CNN&DNN
DNN

CNN

LR
ENSEMBLE

90 time steps ail 120 time steps
(15 minutes) (20 minutes)

8th minnute 12th minnute 0 4th minnute 12th minnute 20th minnute
Time Steps Time Steps

Figure 5. Accumulated root mean square error of each model over 20 energy channels of Earth's outer radiation belt changing with time under different prediction

scales.

TANG ET AL.

prediction effect is small. It means that the machine learning forecast have somehow worse effects at medium or
high electron energies.

In order to compare the overall prediction effect of these five models, Figure 7 presents the sum of RMSE from
all prediction period and energy channels corresponding to each model, when N = 45 (7.5 min), 60 (10 min), 90
(15 min) and 120 (20 min) time steps. It is very obvious that the overall effects of five models are followed by
DNN < CNN < CNN&DNN < LR < Ensemble. The accumulated RMSE values from five models are very close
when the total prediction period is short, like N = 45, which means each model can achieve relatively good performance for a very short-time prediction period. However, as the prediction period increases, the performances
of those models have distinct differences. The combination of CNN and DNN (CNN&DNN) will obtain smaller
RMSE than independent DNN or CNN model. The LightGBM ensemble model, which integrated the effects of
the other four models, performs the best result.

Moreover, it should be noted that the above experiments have not included any solar wind or geomagnetic activity conditions as parameter inputs for our machine leaning models since we only consider a very short-time
electron flux prediction. Therefore, we use two geomagnetic activity indices (AE and SYM-H, as indicators of
the magnetospheric response to solar wind conditions) as additional input parameters to further compare the
prediction effects with and without the external magnetospheric environmental variations. When we do normalization processing for the electron fluxes, we also normalized the AE and SYM-H parameters during the
data processing phase. Then we fed the normalized AE and SYM-H values, along with the normalized flux and
position information, into the ensemble model as training parameters. Figure 8 presents the differences of the
accumulated RMSE values obtained from the LightGBM ensemble model with and without geomagnetic indices,
for the different prediction time-scale NV = 90, 180, 240, and 360 time steps (corresponding to 15 ~ 60 min). The
AE and SYM-H indices are chosen from | hr to 24 hr ahead. The x-axis represents the prediction time. The y-axis
represents the RMSE differences that the predicted RMSE with geomagnetic parameters minus those without

9 of 17
A”
Pa\e TS Space Weather 10.1029/2021SW002969

ADVANCING EARTH
AND SPACE SCIENCE

0.040 CNN&DNN 45 time steps
DNN (7.5 minutes)

0.035 a
0.030 LR
ENSEMBLE
(xy 0.025
S
0.020
a

0.040 CNN&DNN 60 time steps

ee DNN (10 minutes)
CNN

0.030 LR

ENSEMBLE

0.000 0.000
31.5keV = 143.5keV 464.4keV 1S47keV 42 16keV so 31.5keV_ 143. 5keV 464.4keV 1547keV 4216keV

CNN&DNN 90 time steps
DNN (15 minutes)
CNN

LR

ENSEMBLE

RMSE

0.05
CNN&DNN 120 time steps
DNN (20 minutes)
0.04 CNN
LR
ENSEMBLE
0.03
0.02
0.01

0.000 0.00
31.5keV = 143.5keV 464.4keV 1S47keV—s 4216keV so 31.5keV_ 143. 5keV 464.4keV 1547keV 4216keV

Energy

Energy

Figure 6. Accumulated root mean square error of each model at different energy channel of Earth's outer radiation belt under different prediction scales.

geomagnetic parameters. It can be clearly seen that, at the beginning of four different prediction time-scales, the

prediction effects by adding AE and SYM-H parameters are worse than those without two geomagnetic activity

conditions (indicated by the region of positive values), which clearly means that the short-time prediction of

electron differential fluxes can be valid and better without external geomagnetic parameters. However, when the

[x107*]
5
DNN
CNN
4 CNN&DNN

LR
Ensemble

1.799
1.6941.684

1.460 1.456

45 time steps 60 time steps 90 time steps 120 time steps
(7.5 minutes) (10 minutes) (15 minutes) (20 minutes)

Prediction Scale

Figure 7. The sum of root mean square error of each model over 20 energy
channels of Earth's outer radiation belt in different prediction scales.

TANG ET AL.

time step increases, the performance of the ensemble model with these two
geomagnetic parameters gradually improves over the original model (indicated by the region of negative values). The impacts of AE and SYM-H on the
ensemble model will become more significant. When the time step goes to
around 500 time steps (almost 80—90 min), the external magnetospheric conditions should be definitely added, which gives us the limit of the short-time
prediction. Based on our further experiments, the L and MLT from 30 input
samples will not change much. However, when the prediction time scale increases, the L value of predicted samples can reach 1 L-shell and the difference of MLT can be 2 hr. In such a case, the orbit of RBSP-A will be changed
a lot so that the short-time flux prediction without the geomagnetic indices
or solar wind parameters will be invalid. Furthermore, for the short-time prediction, we think that the 30 samples as the model inputs already included the
impact of current AE or SYM-H. At this moment, we can ignore these impact
for a very short period. Finally, we believe that the short-time prediction only
works during several minutes to 15 min (before the green shadows). When
the prediction time-scale goes to around 500 time steps (almost 80-90 min),
the external magnetospheric conditions should be definitely added, which
gives us the limit of the short-time prediction.

10 of 17
Avni |
rid
ADVANCING EARTH
AND SPACE SCIENCE

S
iN

=
iv

2S
=)

=
Ne)

So
aN

1
S
om

=== 12 hours
=== 16 hours
=== 18 hours
=== 20 hours
=== 22 hours
=== 24 hours

The difference between the RMSE of two prediction
(with and without geomagnetic parameters)
_ So
° 0

an
Ne)
S

Step 18
(3rd minute)

S
n

S
S

S
MN

—
j=)

1 hours
2 hours
4 hours
8 hours
12 hours
16 hours
18 hours
20 hours
22 hours
24 hours

—
Nn

mS
°

The difference between the RMSE of two prediction
(with and without geomagnetic parameters)
nS

Step
(10th m

60
inute)

Step 36
(6th minute)

Space Weather 10.1029/2021SW002969

0.5
0f-—-———-—--=—=

-0.5

1 hours
2 hours
4 hours
8 hours
12 hours
16 hours
18 hours
20 hours
22 hours
24 hours

-2.0

Step 120
(20th minute)

Step 60
(10th minute)

-2.5
Step 90 0
(15th minute)

Step 180

Step 54 Step 72
(9th minute) (12th minute) (30th minute)

1

1 hours
2 hours
4 hours
8 hours
12 hours
16 hours
18 hours
20 hours
22 hours
24 hours

Step 360
(60th minute)

Step 240

Step 120
(40th minute)

(20th minute)
Time Steps

Step 180
(30th minute)

Step 240 0
(40th minute)

Step 120
(20th minute)
Time Steps

Figure 8. The differences of the accumulated root mean square error values obtained from the light gradient boosting machine ensemble model with and without
geomagnetic indices, for the different prediction time-scale N = 90, 180, 240, and 360 time steps (corresponding to 15 ~ 60 min). The AE and SYM-H indices are

chosen from 1 hr to 24 hr ahead.

TANG ET AL.

4. Further Experiments on Saturn

Based on the above experiments, a more ideal short-time prediction of electron differential flux can be achieved
without adding solar wind or geomagnetic activity parameters in the Earth's outer radiation belt, which indicates
that the effects of the external conditions will not affect the short-time prediction. Since those solar wind or geomagnetic conditions are not easy to measure in other planets, such as Saturn, and Cassini spacecraft does not have
instruments specifically designed to measure Saturn's solar wind parameters, the extrapolated data can produce
unexpected errors once putting into machine learning models. Therefore, we further apply these five machine
learning models in the short-time prediction of Saturn's electron flux based on local L, MLT, and MLAT parameters to provide a planetary application.

Similarly with RBSP-A satellite, Cassini spacecraft also measured multiple channels of electron differential fluxes, and here we used the channels CO-C7 and E0-E4, which cover 18-4950 keV. The time period is from 1 July
2004 to 15 September 2017. In order to perform our algorithms mainly in the Saturn's inner magnetosphere, we
selected the electron flux data based on two conditions: (a) The L-shell of all observed data one should be within
20 R, (Saturn's radius); (b) The corresponding MLAT value should be within +15°. These two limitation can
make sure that all electron flux data are mainly from the Saturn's inner magnetosphere and close to the equatorial
plane. Therefore, the data sampling method will follow the exactly same rules as those used on the RBSP-A,
except that the accuracy of the electron flux at Saturn is | minute. (It will correspond to the changes of the prediction time scale: from N = 45 to N = 120). In Saturn's experiments, the previous DNN, CNN, CNN&DNN,
LR, and LightGBM ensemble model are still used. It should be noted that, due to the large difference between
different channels, all Saturn's electron flux data will be normalized by Flux,,,,., = 108 ,)(Flux,,; + 5) in order to
facilitate faster convergence for all of above models, where Flux, , is the original flux data and Flux is the

norm

11 of 17
Avni |
rid
ADVANCING EARTH
AND SPACE SCIENCE

Table 2

The Details of Data Sets and Time Ranges From Cassini Satellite

Space Weather

Total data numbers

Training data numbers

Test data numbers

Training time start

Training time end

Test time start

Test time end

N=45
15228
12182

3046
2004/07/01
2016/06/04
2016/06/04
2017/09/15

N=60
12586
10068

2518
2004/07/01
2016/06/06
2016/06/06
2017/09/15

N=90
9345
7476
1869

2004/07/01
2016/06/06
2016/06/06
2017/09/15

10.1029/2021SW002969

N = 120
7348
5878
1469

2004/07/01
2016/06/04
2016/06/04
2017/09/15

normalized data that put into the prediction model. Table 2 then gives the specific number of the training and test
sets with their time ranges corresponding to Cassini satellite in our further experiments.

As shown in Figure 9, we present a similar comparison plot of the predicted and observed electron differential
fluxes in two channels, like 92-183 keV and 110-365 keV, during 4 June 2016 to 3 May 2017. From top to

92 to 183keV 110 to 365keV

wea Normalized Observational Flux 7 wea Normalized Observational Flux
— Predicted Flux 6 Predicted Flux faa
5 =
4 =
3 za
2 E
1
0
2016-06-04 2016-10-15 2017-01-04 2017-03-09 2017-05-03 2016-06-04 2016-10-15 2017-01-04 2017-03-09 2017-05-03
mea Normalized Observational Flux 7 mee Normalized Observational Flux
— Predicted Flux 6 —— Predicted Flux
5
< 4 =
= 3
ae
4 2
cD)
: 1
Z 2016-06-04 2016-10-15 2017-01-04 2017-03-09 2017-05-03 26 6-06-04 2016-10-15 2017-01-04 2017-03-09 2017-05-03
= Normalized Observational Flux 7 wee Normalized Observational Flux
1s; Predicted Flux 6 Predicted Flux
— 5
aa
- 4
a 3
r= 2
i)
5 1
= 0
O 2016-06-04 2016-10-15 2017-01-04 2017-03-09 2017-05-03 2016-06-04 2016-10-15 2017-01-04 2017-03-09 2017-05-03
cP,
Ny Normalized Observational Flux 7 wea Normalized Observational Flux
— Predicted Flux 6 Predicted Flux
fae)
= 5
S 4 SE
Zz, 3 O
2
1
0
2016-06-04 2016-10-15 2017-01-04 2017-03-09 2017-05-03 2016-06-04 2016-10-15 2017-01-04 2017-03-09 2017-05-03

m= Normalized Observational Flux
—— Predicted Flux

Normalized Observational Flux
Predicted Flux

DNN

So rFeFN WwW BNO ~

ee

2016-06-04

2016-10-15

2017-01-04 2017-03-09 2017-05-03 2016-06-04 2016-10-15 2017-01-04
Time Time

2017-03-09 2017-05-03

Figure 9. The comparison of observed Saturn's electron flux with predictions of five models at two energy channels over the same period of time.

TANG ET AL. 12 of 17
Avni |
rid
ADVANCING EARTH
AND SPACE SCIENCE

Space Weather 10.1029/2021SW002969

bottom, the prediction models are LightGBM ensemble, LR model, CNN&DNN, CNN, and DNN model, respectively. It is very obvious that all five models can still achieve very good prediction performances, which is the
same as those experiments in the Earth. The peak value of the predicted flux value is also slightly smaller than the
peak value of the observed data. Because of the different normalization formula, the cross-border phenomenon
is not obvious here.

Figure 10 presents the compared plots of the scattered data point during 175-300 keV from the predicted when
N = 120 (120 min) and observed electron fluxes following the format of Figure 4. The corresponding Person CC
and RMSE are shown to check the model prediction performances. Slightly different from Figure 4, CC values
are smaller and the RMSE values are a little larger than those from the Earth's inner magnetosphere. The reason
is that all data samples from the Cassini observations are less and also have more abnormal values. However, it
can still be seen that the prediction performances of all models are still valid and good. The model effects become

Step 1 Step 30 Step 60 Step 90 Step 120
(1st minute) (30th minute) (60th minute) (90th minute) (120th minute)

5.1 5.0
4.4 4.3 4.8 4.2 4.1 =
3.7 3.6 4.0 3.5 3.5 S
3.0 2.9 3.2 2.9 | foo. 2.8 eA
2.3 CC:0.9928 2.2 -| ” cc-0.9501 *| 2-4 * cooosie | 2-2 i sce CC:0.9154 2.2 Bf m9 *CC-0.8897 a
16 RMSE:0.0482 | 1 « p* __RMSE:0.1253 | 5 ¢ RMSE:0.1371] 1 ¢ RMSE:0.1638 | 1 ¢ ee$*  RMSE:0.1906

1.6 2.3 3.03.7445.1 1522293643 5.0 162432404856 162.2 2.93.5 4.2 4.8 1.6 2.2 2.8 3.5 4.1 4.8
5.2 5.1 5.7 4.9 4.9
4.4 4.4 4.9 4.2 4.2
eA 3.6 4.0 | 3.5 3.)
3.0 2.9 a2 2.8 2.8
2.2 cc-0.9946 | 2-2 oc:0.9497 °| 2.3 * c.0.9303_| 2-1 es* = CC:0.9101 2.1 >. ae CC:0.873
15 RMSE:0.0412| 4 4 RMSE:0.1261] ) = {fl RMSE:0.1407] 4 « RMSE:0.1705 | 5 $° _RMSE:0.2079

1.5 2.2303.74452 14222936445.1 1.5 2.33.2 4049 5.7 1.5 2.1 2.83.5 4.2 4.9 1.5 2.1 2.8 3.5 4.2 4.9

ws
|
—]
Ly
—_—
3
=
& 52 5.1 5.7
OD 44 4.4 4.9
=
S 3.7 3.6 4.0
5 3.0 2.9 a 3.2 ta
ae] Lon CC:0.8445 aod CC:0.7682 29 CC:0.877 °e CC0.8485 cone
oO 1.5 ( ee RMSE:0.3195 1.4 RMSE:0.3351 1.5 RMSE:0.236 RMSE:0.2353 RMSE:0.3611
= 1.5 2.2 3.03.74.452 1.42.2 2.9 3.64.4 5.1 1.5 2.1 2.8 3.5 4.2 4.9
S 52 5.1 5.7 4.9
E 4.4 4.4 4.9 4.2
7 3.7 3.6 4.0 3.5
3.0 2.9 39 2.8
2.2 ° *CC:0.8707 Lake CC:0.8659 2.3 ° CC:0.8491 CC:0.7796 Zl * 00-0.7986
1. 5 , RMSE:0.2579 1. 4 RMSE:0.2589 1. 5 RMSE:0.2765 RMSE:0.3167 1. 5 RMSE:0.3637
1.5 2.2 3.03.74452 142229364451 1.5 2.33240495.7 1.52.1 2.83.54249 1.5 2.1 2.8 3.5 4.2 4.9
5.2 5.1 5.7 4.9 49
4.4 | 4.4 4.9 42 4.2
a7 3.6 4.0 3.5 3.5
3.0 2.9 oe. 45 2.8 2.8
Luke CC:0.902 Mie ° "0C-0.8119 ° 2.3 CC:0.8831 2.1 Loud * 0C-0.8671

RMSE:0.2781

1.5
1.5 2.2 3.0 3.7 4.4 5.2

1.4

RMSE:0.2976

1.5 2.1 2.8 3.5 4.2 4.9

RMSE:0.2822 RMSE:0.2314
1.4 2.2 2.9 3.6 4.4 5.1

Normalized Observational Flux

1.5

1.5 ;
1.5 2.3 3.2 404.9 5.7) 1.5 2.1 2.8 3.5 4.2 4.9

Figure 10. The deviation, root mean square error and correlation coefficient of the five models compared with observations of Saturn's electron flux under different

prediction scales.

TANG ET AL.

13 of 17
Avni |
rid
ADVANCING EARTH
AND SPACE SCIENCE

RMSE

RMSE

Wy

4 «

Space Weather

CNN&DNN
DNN

CNN

LR
ENSEMBLE

45 time steps
(45 minutes)

CNN&DNN
DNN

CNN

LR
ENSEMBLE

10.1029/2021SW002969

60 time steps
(60 minutes)

0.0
15th minute 30th minute 45th minute 0 15th minute 30thminute 45thminute 60th minute
0.8
CNN&DNN CNN&DNN
DNN 0.7 DNN
CNN CNN
LR 0.6 LR
ENSEMBLE Vis rr .| 0.5 ENSEMBLE
~ ae ‘
Ll SS ee 0.4
—_— 0.3
0.2
90 time steps} 9.1 120 time steps
(90 minutes) ai (120 minutes)
30th minute 60th minute 90th minute 0 30th minute 60thminute 90thminute 120th minute
Time Steps Time Steps

Figure 11. Accumulated root mean square error of each model over 13 energy channels of Saturn changing with time under different prediction scales.

TANG ET AL.

worse with the increase of prediction time step. LR model still performs well in Saturn and CNN&DNN model
performs slightly worse than LR model. The LightGBM ensemble model is also the best among the five models.

Figures 11 and 12 also give the statistical results of the accumulated RMSE value for different prediction
time scale and different energy channels, as the same format with Figures 5 and 6. It can be seen from both
two figures that the LightGBM ensemble model and LR model have very similar prediction performances,
and the CNN model and CNN&DNN model are very close. From the two figures, we can be certain that the
RMSE of all models grows as the time scale increases. But the LightGBM ensemble model still have the best
effect. Finally, as shown in Figure 13, we give the total accumulated RMSE values from five machine learning
models based on different prediction time scale. The error of prediction results of those models are followed
by DNN > CNN > CNN&DNN > LR > LightGBM, which are roughly the same as those on Earth. The only
difference is that the CNN&DNN model does not show better results than the CNN model when the prediction
time is extended. However, the LightGBM ensemble model also performs best effect among the five prediction models. It significantly proves that the short-time electron flux prediction can still work in the deep space
explorations.

5. Conclusions

In this paper, for the first time, we present a short-time prediction for the electron differential flux based on five
machine learning models, including the DNN, the CNN, the combination of CNN and DNN (CNN&DNN), the
LR, and the LightGBM. In order to quickly obtain the prediction results, we only considered the local parameters,
like L, MLT, MLAT, and the observed electron flux data at observed 30 data samples (nearly 5 min on Earth) to
predict electron flux for next 45, 60, 90, and 120 time steps, which correspond to 7.5, 10, 15, and 20 min on Earth,
respectively. Based on the observed data of all 20 energy levels (from 31.5 to 4216 keV) from the MagEIS instru
14 of 17
A”
Pa\e TS Space Weather 10.1029/2021SW002969

ADVANCING EARTH
AND SPACE SCIENCE

1.0
45 time steps CNN&DNN
(45 minutes) DNN

0.8 CNN

LR
ENSEMBLE

1 3iod0keV 56to100keV 510to832keV 790to4750keV
1.0
90 time steps
(90 minutes) DNN

0.8 CNN
LR

ENSEMBLE
0.6

RMSE

0.4

0.2

0.0 —
18to40keV 56tol00keV 510to832keV 790to4750keV

Energy

60 time steps CNN&DNN
(60 minutes) DNN

CNN

LR

ENSEMBLE

1 3iod0keV 56to100keV 510to832keV 790to4750keV
1.0
120 time steps
(120 minutes)
0.8 CNN

LR

ENSEMBLE
0.6

0.4

0.2

a

0.0 ———
18to40keV 56tol00keV 510to832keV 790to4750keV
Energy

Figure 12. Accumulated root mean square error of each model at different energy channel under different prediction scales of Saturn.

ment of the RBSP-A satellite during 31 March 2013 to 31 December 2017, we present the detailed comparisons
of the predicted electron flux and observed flux data. The DNN model was determined to have the poorest overall
effect, whereas the CNN model was neither excellent nor terrible. For a short period, the combination of CNN
and DNN model has a poor prediction performance, but it will improve over time. The LR model is effective
in the short term, but it deteriorates with time. The LightGBM ensemble model can achieve the best prediction
performance among those five models since the corresponding RMSE values is always smallest for different

[x107*]
9 Ea DNN
g ~~ CNN
ma CNN&DNN 1356
7| Gm LR —
Me Ensemble
é 6.073
5.237 5.2995.286 5.3065 199

4.5954 515

4.3044.273

RMSE
aS

3.7953.736

45 time steps 60 time steps 90 time steps 120 time steps
(45 minutes) (60 minutes) (90 minutes) (120 minutes)

Prediction Scale

Figure 13. The sum of root mean square error of each model over 13 energy
channels of Saturn in different prediction scales.

TANG ET AL.

prediction time scale, says N = 45, 60, 90, and 120 in our experiments. In
such a case, it can be concluded that the short-time prediction of electron flux
from our machine learning algorithms can reach a satisfactory effect by only
using the historical flux data and location information. The impact of the
solar wind parameter or geomagnetic activity conditions can also be ignored
for a very short-time prediction. Furthermore, we applied this method to Saturn's electron flux prediction and the prediction performances of all models
are still similar with those from the Earth. The LightGBM ensemble model
finally obtains the best prediction result.

It should be noted that a long-time deep learning prediction of the planetary
space weather usually requires a lot of real-time or historical observation data
for external environment parameters. It is still hard to collect most of those
data from limited satellite missions, which may dramatically affect current
artificial intelligence applications in deep space explorations. Our short-time
electron flux prediction gives a new insight in the space weather applications
based on machine learning, which will be critical for practical applications
to the instrument designs and system operations of new scientific satellites in
the space radiation environment.

15 of 17
vrij
rid
ADVANCING EARTH
AND SPACE SCIENCE

Acknowledgments

This work was supported by National
Natural Science Foundation of China
under grants 41974195, 41974183, and
the Interdisciplinary Innovation Fund of
Natural Science from Nanchang University under Grant 9166-27060003-YB 14.
The authors thank the Space Physics Data
Facility (SPDF) for providing the RBSP
data and Kyoto data centre for providing
the OMNI data. The authors also thank
Applied Physics Laboratory (APL) of
Johns Hopkins University for providing
the MIMI/LEMMS data.

TANG ET AL.

Space Weather 10.1029/2021SW002969

Data Availability Statement

The RBSP data and OMNI data are public available from the site (https://cdaweb.gsfc.nasa.gov). The OMNI data
are accessible to the public and can be found on the website (http://wdc.kugi.kyoto-u.ac.jp/wdc/Sec3.html). The
MIMI/LEMMS data can be obtained at the site (https://pds-ppi.igpp.ucla.edu). The results of our experiment can
be obtained here (https://github.com/taoyuhao/taoyuhao/releases/tag/DATA).

References

Bala, R., Reiff, P. H., & Landivar, J. E. (2009). Real-time prediction of magnetospheric activity using the Boyle Index. Space Weather-the International Journal of Research and Applications, 7, SO4003. https://doi.org/10.1029/2008SW000407

Blake, J. B., Carranza, P. A., Claudepierre, S. G., Clemmons, J. H., Crain, W. R., Dotan, Y., et al. (2013). The magnetic electron ion spectrometer (MagEIS) instruments aboard the radiation belt storm probes (RBSP) spacecraft. Space Science Reviews, 1791-4), 383-421.
https://doi.org/10.1007/s11214-013-9991-8

Bolton, S. J., Hansen, C. J., Matson, D. L., Spilker, L. J., & Lebreton, J. P. (2004). Cassini/Huygens flyby of the Jovian system. Journal of Geophysical Research, 109(A9). https://doi.org/10.1029/2004JA010742

Carbary, J. F., Roelof, E. C., Mitchell, D. G., Krimigis, S. M., & Krupp, N. (2009). Solar wind periodicity in energetic electrons at Saturn. Geophysical Research Letters, 36, L22104. https://doi.org/10.1029/2009GL04 1086

Chen, Y., Reeves, G. D., Fu, X., & Henderson, M. (2019). PreMevE: New predictive model for megaelectron-volt electrons inside Earth’s outer radiation belt. Space Weather-the International Journal of Research and Applications, 17(3), 438-454. https://doi.org/10.1029/2018SW002095

Chen, Z., Jin, M., Deng, Y., Wang, J.-S., Huang, H., Deng, X., & Huang, C.-M. (2019). Improvement of a deep learning algorithm for total electron content maps: Image completion. Journal of Geophysical Research: Space Physics, 124, 790-800. https://doi.org/10.1029/2018JA026167

Chu, X., Ma, D., Bortnik, J., Tobiska, W. K., Cruz, A., Bouwer, S. D., et al. (2021). Relativistic electron model in the outer radiation belt using a
neural network approach. Space Weather, 19, e2021SW002808. https://doi.org/10.1029/2021SW002808

Cichy, R. M., & Kaiser, D. (2019). Deep neural networks as scientific models. Trends in Cognitive Sciences, 23(4), 305-317. https://doi.
org/10.1016/j.tics.2019.01.009

He, H., Wang, H., Du, Z., Li, R., Cui, Y., Zhang, L., & He, Y. (2008). Solar activity prediction studies and services in NAOC. Advances in Space
Research, 42(9), 1450-1456. https://doi.org/10.1016/j.asr.2007.02.068

Kadiyala, A., & Kumar, A. (2018). Applications of python to evaluate the performance of bagging methods. Environmental Progress & Sustainable Energy, 37(5), 1555-1559. https://doi.org/10.1002/ep.13018

Koons, H. C., & Gorney, D. J. (1991). A neural network model of the relativistic electron flux at geosynchronous orbit. Journal of Geophysical
Research, 96(A4), 5549-5556. https://doi.org/10.1029/90JA02380

Krimigis, S. M., Mitchell, D. G., Hamilton, D. C., Livi, S., Dandouras, J., Jaskulek, S., et al. (2004). Magnetosphere imaging instrument (MIMI)
on the Cassini mission to Saturn/Titan. Space Science Reviews, 114(1-4), 233-329. https://doi.org/10.1007/978-1-4020-2774-1_3

Krupp, N., Roussos, E., Lagg, A., Woch, J., Mueller, A. L., Krimigis, S. M., et al. (2009). Energetic particles in Saturn’s magnetosphere during the Cassini nominal mission (July 2004—July 2008). Planetary and Space Science, 5714-15), 1754-1768. https://doi.org/10.1016/j.
pss.2009.06.010

LeCun, Y., Bengio, Y., & Hinton, G. (2015). Deep learning. Nature, 521(7553), 436-444. https://doi.org/10.1038/nature 14539

Lethy, A., El-Eraki, M. A., Samy, A., & Deebes, H. A. (2018). Prediction of the Dst index and analysis of its dependence on solar wind
parameters using neural network. Space Weather-the International Journal of Research and Applications, 16(9), 1277-1290. https://doi.
org/10.1029/2018SW001863

Ling, A. G., Ginet, G. P., Hilmer, R. V., & Perry, K. L. (2010). A neural network-based geosynchronous relativistic electron flux forecasting
model. Space Weather-the International Journal of Research and Applications, 8. https://doi.org/10.1029/2010S W000576

Mcllwain, C. E. (1961). Coordinates for mapping the distribution of magnetically trapped particles. Journal of Geophysical Research, 66(11),
3681-3691. https://doi.org/10.1029/JZ066101 1p03681

Myagkova, I. N., Dolenko, S. A., Efitorov, A. O., Shirokii, V. R., & Sentemova, N. S. (2017). Prediction of relativistic electron flux in the
Earth’s outer radiation belt at geostationary orbit by adaptive methods. Geomagnetism and Aeronomy, 57(1), 8-15. https://doi.org/10.1134/
$0016793217010108

Ni, B., Huang, H., Zhang, W., Gu, X., Zhao, H., Li, X., et al. (2019). Parametric sensitivity of the formation of reversed electron energy spectrum
caused by plasmaspheric hiss. Geophysical Research Letters, 46(8), 4134-4143. https://doi.org/10.1029/2019GL082032

Ni, B., Shprits, Y., Thorne, R., Friedel, R., & Nagai, T. (2009). Reanalysis of relativistic radiation belt electron phase space density using
multisatellite observations: Sensitivity to empirical magnetic field models. Journal of Geophysical Research, 114, A12208. https://doi.
org/10.1029/2009JA014438

Pires de Lima, R., Chen, Y., & Lin, Y. (2020). Forecasting megaelectron-volt electrons inside Earth’s outer radiation belt: PreMevE 2.0 based
on supervised machine learning algorithms. Space Weather-the International Journal of Research and Applications, 18(2). https://doi.
org/10.1029/2019SW002399

Ramirez, J. F., Fuentes, O., & Gulati, R. K. (2001). Prediction of stellar atmospheric parameters using instance-based machine learning and
genetic algorithms. Experimental Astronomy, 12(3), 163-178. https://doi.org/10.1023/A:1021899116161

Shprits, Y. Y., Vasile, R., & Zhelayskaya, I. S. (2019). Nowcasting and predicting the Kp index using historical values and real-time observations.
Space Weather-the International Journal of Research and Applications, 17(8), 1219-1229. https://doi.org/10.1029/2018SW002141

Smirnov, A. G., Berrendorf, M., Shprits, Y. Y., Kronberg, E. A., Allison, H. J., Aseev, N. A., et al. (2020). Medium energy electron flux in Earth’s
outer radiation belt (MERLIN): A machine learning model. Space Weather-the International Journal of Research and Applications, 18(11).
https://doi.org/10.1002/essoar.10503072.1

Summers, D., Tang, R., & Thorne, R. M. (2009). Limit on stably trapped particle fluxes in planetary magnetospheres. Journal of Geophysical
Research, 114, A10210. https://doi.org/10.1029/2009JA0 14428

Tang, R., & Summers, D. (2012). Energetic electron fluxes at Saturn from Cassini observations. Journal of Geophysical Research, 117. https://
doi.org/10.1029/2011JA017394

Tang, R., Summers, D., & Deng, X. (2014). Effects of cold electron number density variation on whistler-mode wave growth. Annales Geophysicae, 32(7), 889-898. https://doi.org/10.5194/angeo-32-889-2014

16 of 17
vrij
rid
ADVANCING EARTH
AND SPACE SCIENCE

TANG ET AL.

Space Weather 10.1029/2021SW002969

Tang, R. X., Liao, W. T., Chen, Z., Zeng, X. W., Wang, J. S., Luo, B. X., et al. (2021). Solar flare prediction based on the fusion of multiple
deep-learning models. The Astrophysical Journal - Supplement Series, 257(2), 50. https://doi.org/10.3847/1538-4365/ac249e

Tang, R. X., Zeng, X. W., Chen, Z., Liao, W. T., Wang, J. S., Luo, B. X., et al. (2021). Multiple CNN variants and ensemble learning for sunspot
group classification by magnetic type. The Astrophysical Journal - Supplement Series, 257(2), 10. https://doi.org/10.3847/1538-4365/ac249f

Ukhorskiy, A. Y., Sitnov, M. I., Sharma, A. S., Anderson, B. J., Ohtani, S., & Lui, A. T. Y. (2004). Data-derived forecasting model for relativistic
electron intensity at geosynchronous orbit. Geophysical Research Letters, 31(9), LO9806. https://doi.org/10.1029/2004GL019616

Wang, C., Deng, C. Y., & Wang, S. Z. (2020). Imbalance-XGBoost: Leveraging weighted and focal losses for binary label-imbalanced classification with XGBoost. Pattern Recognition Letters, 136, 190-197. https://doi.org/10.1016/j.patrec.2020.05.035

Xu, S. B., Huang, S. Y., Yuan, Z. G., Deng, X. H., & Jiang, K. (2020). Prediction of the Dst index with bagging ensemble-learning algorithm. The
Astrophysical Journal - Supplement Series, 248(1), 14. https://doi.org/10.3847/1538-4365/ab880e

Yu, C., & Yao, W. (2017). Robust linear regression: A review and comparison. Communications in Statistics - Simulation and Computation,
46(8), 6261-6282. https://doi.org/10.1080/03610918.2016.1202271

17 of 17
