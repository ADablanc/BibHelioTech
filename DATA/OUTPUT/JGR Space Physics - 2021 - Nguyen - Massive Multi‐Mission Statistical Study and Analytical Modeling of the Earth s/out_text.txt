® Check for updates

Ah = a il ADVANCING
PAIS space science

JGR Space Physics

TECHNICAL

REPORTS: METHODS
10.1029/2021JA029773

This article is a companion to Nguyen
et al. (2022a), https://doi.org/10.1029/
2021JA029774; Nguyen et al. (2022b),
https://doi.org/10.1029/2021JA030112;
and Nguyen et al. (2022c), https://doi.
org/10.1029/2021JA029776.

Key Points:

e A gradient boosting algorithm is
used to classify the magnetosphere,
magnetosheath and solar wind in situ
data from multiple missions

e The method outperforms the detection
methods based on manual threshold
and is trained faster than existing
machine-learning based methods

e The method is used to identify 15,062
magnetopause crossings and 17,227
bow shock crossings

Correspondence to:
G. Nguyen,
gautier-mahe.nguyen @intradef.gouv.fr

Citation:

Nguyen, G., Aunai, N., Michotte de
Welle, B., Jeandet, A., Lavraud, B., &
Fontaine, D. (2022). Massive multimission statistical study and analytical
modeling of the Earth's magnetopause:
1. A gradient boosting based automatic
detection of near-Earth regions. Journal
of Geophysical Research: Space Physics,
127, e2021JA029773. https://doi.
org/10.1029/2021JA029773

Received 9 JUL 2021
Accepted 5 DEC 2021

© 2021. American Geophysical Union.
All Rights Reserved.

NGUYEN ET AL.

Massive Multi-Mission Statistical Study and Analytical
Modeling of the Earth's Magnetopause: 1. A Gradient
Boosting Based Automatic Detection of Near-Earth Regions
G. Nguyen!? ©, N. Aunai! ©, B. Michotte de Welle!, A. Jeandet!, B. Lavraud? ©, and D. Fontaine! ©

'CNRS, Ecole polytechnique, Sorbonne Université, Université Paris Sud, Observatoire de Paris, Institut Polytechnique de
Paris, Université Paris-Saclay, PSL Research Univsersity, Laboratoire de Physique des Plasmas, Palaiseau, France, Direction
Générale de l’Armement, Paris, France, *Laboratoire d'astrophysique de Bordeaux, University of Bordeaux, CNRS, Pessac,
France, “Institut de Recherche en Astrophysique et Planétologie, Université de Toulouse, CNRS, CNES, Toulouse, France

Abstract We present an automatic classification method of the three near-Earth regions, the
magnetosphere, the magnetosheath and the solar wind from their in situ data measurement by multiple
spacecraft. Based on gradient boosting classifier, this very simple and very fast method outperforms the
detection routines based on manually set thresholds. The method is used to identify 15,062 magnetopause
crossings and 17,227 bow shock crossings in the data of 11 different spacecraft of the THEMIS, ARTEMIS,
Cluster, MMS, and Double Star missions and for a total of 83 cumulated years. These multi-mission catalogs
are easily reproducible, can be automatically enlarged with additional data and their elaboration paves the way
for future massive statistical analysis of near-Earth boundaries.

1. Introduction

The magnetopause is the boundary where magnetospheric and magnetosheath pressures balance, and where magnetic fields of terrestrial and solar origin interact. It acts like an obstacle for the upcoming supersonic solar wind
and is thus located downstream a collisionless bow shock (Burgess, 1995) across which the solar wind becomes
subsonic. The magnetopause and the bow shock are the boundaries of the three main near-Earth regions: the
magnetosphere, the magnetosheath and the solar wind. By definition, the shape, location and properties of these
boundaries depend on the upstream solar wind conditions (Fairfield, 1971). The ever-growing quantity of nearEarth in situ data allowed the realisation of statistical studies dedicated to the physical properties of the different
near-Earth regions and to the position, shape and dynamics of both the magnetopause (Berchem & Russell, 1982;
Haaland et al., 2014; Hasegawa, 2012; Lukin et al., 2019; Némecek et al., 2020; Panov et al., 2008, Paschmann
et al., 2018; Phan & Paschmann, 1996 and references therein) and the bow shock (Kruparova et al., 2019 and
references therein). Such studies also led to the development of numerous magnetopause (Lin et al., 2010; Liu
et al., 2015; Shue et al., 1997; Wang et al., 2013 and references therein) and bow shock (Farris & Russell, 1994;
Jerab et al., 2005; Wu et al., 2000 and references therein) surface models.

The first step of both empirical modeling and statistical studies is always the same: establishing a consistent
catalog of boundary crossings from the streaming in situ data provided by missions of interest. This, in addition
to being time-consuming, is an ambiguous task, strongly linked to the interpretation of an external observer and
thus poorly reproducible. As a result, catalogs of events are difficult to make and their size represents, with time,
an ever decreasing proportion of the total and massive amount of public multi-mission data that has been accumulating for decades. This severely hampers the development of a statistically relevant and global vision of our
near space environment and plasma processes therein. Consequently, the elaboration of automatic event detection
methods in streaming in situ time series data provided by spacecraft appears as an interesting option to accelerate the collection of boundary crossings and improve the reproducibility and robustness of statistical studies.
Figure | shows typical observations from a spacecraft traveling outbound through the three regions. From top to
bottom are represented the proton density, the magnetic field components, the ion velocity components and the
omnidirectional energy flux of ions measured by THEMIS B. The last panel will be explained in the following
sections. The three regions are easily distinguishable by eye and the first method we could think about in this
classification task would be to use manually set thresholds on wisely chosen physical quantities. Using the data
provided by the five THEMIS spacecraft coupled with the solar wind conditions provided by WIND, Jelinek
et al. (2012) established a method based on thresholds on the magnetic field amplitude B and the proton density

1 of 31
vrij
riJIW
ADVANCING EARTH
AND SPACE SCIENCE
a 10!
£
=,
Q 0
= 10
107}
50
25
he
= 0
aa)
—25
—50
200
Y 0
§
S -200
—400
S 4
o 10
>
oD)
)
VY
| Es
<0)
WY
ed
2

Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

08:00

08:00

08:00

—— Label

11:00 14:00 17:00

| | |
Pee

11:00 14:00 17:00

| | |
SEs

11:00 14:00 17:00

10® _
=
10° ?
a
12
10 =
a
2 =
10 a

11:00 14:00 17:00 10°

— Prediction

08:00

11:00 14:00 17:00

Figure 1. In situ measurement provided by THEMIS B spacecraft on the 12 May 2008. From the top to the bottom are represented: the ion density, the magnetic
field components, the velocity components the omnidirectional differential energy fluxes of ions. The last bottom panel represents the evolution of the label (blue),
intentionally shifted for visual inspection and the prediction made by our algorithm (black).

NGUYEN ET AL.

N, normalized by the interplanetary magnetic field (IMF) amplitude and proton density. They used this method to
identify the three near-Earth regions and eventually build lists of crossings from this classification. The principle
of the method consists in manually setting the two straight lines that best separate the three regions in the (WV, B)
plane in a way that is similar to what is shown in Figure 8. Nevertheless, this still requires the manual setting of
thresholds on a reduced number of parameters. There is no guarantee on how well they will do on an unknown set
of data and the separability of the two features presented here is not guaranteed on the whole magnetopause, especially in the case of nightside, flanks or high latitude boundary crossings. Additional, less obvious observational
examples of this case are shown in Appendix E. The method could thus be improved with additional features such
as the amplitude of the ion bulk velocity or the ion temperature but this would lead to the establishment of manual
thresholds in an N-dimensional space, which is a tricky task if done manually.

2 of 31
vrij
rid
ADVANCING EARTH
AND SPACE SCIENCE

NGUYEN ET AL.

Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

A way to go beyond this solution stands in using supervised machine learning algorithms that usually have the
advantage of rapidly finding the intrinsic differences between different labeled points in complex multi-dimensional datasets. The use of these algorithms to classify time series into several categories is not new in the field of
space physics. They have especially proved their effectiveness in classifying the solar wind into several categories
(Camporeale et al., 2017) or to determine if an interval of data contains a Flux Transfer Event (FTE) (Karimabadi
et al., 2009). Recently, Olshevsky et al. (2019), Breuillard et al. (2020) and Argall et al. (2020) all proposed neural
network based methods to classify the different near-Earth regions from the MMS data. The high performances
reached by the three methods confirms the potential and the efficiency of statistical learning algorithms for such
a classification task. Although providing interesting results, the high level of flexibility offered by such deep
learning methods is generally balanced by the large amount of labeled data samples needed and the very long
time they require to converge in their training. It thus appears important to establish reliable methods that require
shorter convergence time.

In this study, we establish such a method by training a gradient boosting algorithm to automatically classify the
three near-Earth regions from the magnetic field and plasma moments of the THEMIS mission. After presenting
the data and the associated labels, we present the algorithm we use and explain this choice. We then evaluate its
performances and investigate its adaptability to the various missions that explore the different parts of the magnetosphere boundaries: Double Star, MMS, Cluster and ARTEMIS. The outcome is then compared to the one
obtained by setting thresholds manually for the different missions. The gradient boosting prediction is then used
to automatically elaborate multi-mission catalogs of boundary crossings. The established catalogs are available
online at: https://doi.org/10.528 1/zenodo.5668298.

In particular, the massive magnetopause crossing catalog obtained in this study is the preamble to companion
studies, focusing on the statistical analysis of the shape and location of the surface and its dependency on solar
wind and seasonal parameters (hereafter Nguyen et al., 2022a), the subsequent building of a new analytical and
dynamical model of the magnetopause surface as a function of relevant upstream and seasonal control parameters
(hereafter Nguyen et al., 2022b), and that re-visits the question of the indentation of the magnetopause surface in
the near-cusp regions (hereafter Nguyen et al., 2022c).

2. THEMIS Data Set

We used plasma moments and magnetic field data from the five THEMIS spacecraft, between April 2007 and
January 2010 for THEMIS B and C and until June 2019 for the three remaining spacecraft. In particular, we
considered the data measured during the dayside, dawn and dusk operation phases. The magnetic field data
were provided by the Fluxgate Magnetometer (FGM, Auster et al., 2008) with a temporal resolution of 3s. Concerning the plasma moments, we used the Fast-Survey mode of the data provided by the electrostatic analyzer
(ESA, McFadden et al., 2008) for which the distribution functions are composed of 24 energy channels and 50
solid-angle distributions with a temporal resolution of 4s. We use the onboard moments to fill in the data gaps
in the Slow-Survey mode. The remaining holes in the plasma moments are filled with the data measured in the
full mode and linearly time interpolated in order to obtain streaming time series of the ion density, velocity, and
temperature with a uniform resolution of 4s. The ESA and FGM measurements are then synchronized to obtain a
unique data set with a common resolution of | min in order to erase the noise due to very punctual partial crossings that will be particularly hard to label and detect.

Due to the important differences existing between the different missions in the specificities of the distribution
functions and particle energy or pitch angle spectrograms, we chose to focus on the plasma moments and magnetic field only. The ion omnidirectional differential energy fluxes shown in Figure | are then only be used for visual
inspection of data and to provide visual guidance in our labeling process.

For each spacecraft, the associated data set then consists in eight distinct input features: the ion bulk velocity components, V,, Vi V., the magnetic field and its components, B,, B,, B., the ion density N,,» and the temperature T.

3. Label

We start our work by considering the THEMIS B data set, the remaining sets will be used when we will perform
the massive detection of boundary crossings in Section 7.

3 of 31
vrij
rid
ADVANCING EARTH
AND SPACE SCIENCE

NGUYEN ET AL.

Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

Each datapoint is associated to a given label that indicates the region in which the spacecraft is at the measurement time:

1. Points in tenuous regions with almost no ion bulk flow and comparatively large magnetic field values are
identified as magnetosphere points.

2. Points in comparatively dense regions with a fast ion bulk flow and low temperature are identified as solar
wind points.

3. Points that are not identified as solar wind or magnetosphere are identified as magnetosheath. Those points
correspond to the denser regions with an intermediate plasma velocity with a wide range energy flux. With
this definition, any region downstream of the bow shock that is not the magnetosphere is considered as the
magnetosheath. This will thus concern pristine magnetosheath points but also the regions composed of mixed
plasmas such as the reconnection outflows, the cusp dense and hot plasma or the different magnetosphere and
magnetosheath boundary layers.

While only considering the above three classes is enough for the purpose of the statistical analysis performed in
the companion papers of this study (Nguyen et al., 2022a, 2022b, 2022c), the classification could be extended to
additional classes. Having a single model classifying many different regions (e.g., solar wind, foreshock, cusps,
boundary layers, lobes, plasma sheet, etc.) may appear appealing at first glance. However, it is worth mentioning that statistical studies rarely need that many classes, and moreover that multiplying classes often needlessly
complicates the classification. Indeed, not only this may require more evolved algorithms thereby increasing the
training time, it also introduces errors that basic knowledge of the Earth environment would prevent. For instance
classifying automatically the ion foreshock from pristine solar wind can much more easily be done on a data
set where all but solar wind data (in a sense of our classification above) has been removed by a first pass of our
classification than on a whole-orbit data set. By construction, this prevents any non-physical errors an observer
would never make in confusing unrelated regions, but also provides a better chance to fine tune the algorithm to
a well defined task, and reduce training time.

We make those labels by inspecting the data visually and deciding, by selecting intervals, to which class their
points belong to.

The typical labeling of the three regions for a 1 min resampled data interval is shown on the last panel of Figure 1
where the theoretical label, shown in blue has been slightly shifted vertically for visualization purposes. With
modern visualization and data science tools (Génot et al., 2010; McKinney, 2010), the interval selection and
labeling of all the points enclosed is an easy and fast task, in particular because the regions are easily identified
visually and without much ambiguity. Following this process, our data set is made of 59,798 magnetosphere
points, 48,056 magnetosheath points and 150,415 solar wind points.

We selected data measured during the dawn, dayside and dusk operation phases of THEMIS and thus expect a
good Magnetic Local Time (MLT) coverage of both magnetopause and shock surfaces. This is confirmed by the
spatial coverage of our labeled data set shown in Figure 2. With such coverage, we expect the method to be robust
enough regarding the variability of the data through the three different THEMIS operation phases.

In the following, we will designate the subset that has been used to fit our algorithm by training set. We will
designate by fest set the remaining subset of data that is used to evaluate the performance of our model. For each
of the configurations we have been testing our algorithm with, the training set represents 70% of the data set
while the test set represents the remaining 30% of the data set. To ensure there is no bias in our evaluation of the
performance, the train and test sets are chosen in distinct time intervals of the THEMIS B mission.

4. Algorithm

The recently developed automatic near-Earth classification routines were all based on the application of a neural
network algorithms (Argall et al., 2020; Breuillard et al., 2020; Olshevsky et al., 2019). These deep learning
methods typically offer a great flexibility leading to good results on complex problems, at the cost of requiring
lots of training data points and long convergence times. In this study, we choose to train a Gradient Boosting algorithm (Friedman, 2001). Such a method may not offer as much flexibility as deep learning methods, but has been
recognized to perform well on complex, eventually imbalanced classification problems (Brown & Mues, 2012)

4 of 31
Avni |
rid
ADVANCING EARTH
AND SPACE SCIENCE

20

10

-15

Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

Ww)
2e
102 10 =
©):
©
+
©
oS
ue
(o)
=
12
1 10
10 =
=P |
=
10° 10°
al 0 5 10 15
Xesm(Re)

Number of data points

Xesm(Re)

Figure 2. Spatial coverage of our labeled THEMIS data set projected in the (X—Y) GSM plane, the solid black line represent a stand-off position the bow shock
following (Jerab et al., 2005) model while the dotted black line represent the magnetopause model of (Lin et al., 2010). Labels are spatially represented in a log-scale
2D histogram. Magnetosphere bins in blue vary between 1 and 901, Magnetosheath bins in red vary between | and 1,421, solar wind bins in green vary between | and

788.

NGUYEN ET AL.

while typically needing much less labeled data and being much lighter to train. The Gradient Boosting is based
on the iterative fit of the residuals obtained by the successive training and predictions made by weak learner
algorithms, here a decision tree. The final prediction results from the convergence of the ensemble of decision
trees on the smallness of the residuals or when the maximum number of trees is reached, and corresponds to the
class with the highest probability.

Since our massive prediction relies on this probabilistic output, and since the Gradient Boosting is known to result
in possibly not-well calibrated probabilities (Niculescu-Mizil & Caruana, 2005), we calibrate it before performing the massive prediction. We show in Appendix B that our model is well-calibrated and that its probabilistic
output can then be used as is.

We computed the method using its Python implementation provided by Scikit-Learn (Pedregosa et al., 2011) with
the default hyperparameters (described here: https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.
GradientBoostingClassifier.html). With the actual size of our data set, it took 2 min for our algorithms to train on
an AMD ryzen ™ threadripper ™2990wx processor.

5 of 31
vrij
rid
ADVANCING EARTH
AND SPACE SCIENCE

NGUYEN ET AL.

Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

5. Results
5.1. Performances

After fitting our Gradient Boosting model to our training set, we evaluate its performance by comparing its
prediction on the fest set with the corresponding labels. The value of the prediction for a given time interval can
be shown in the last subplot of Figure 1. From then on, a prediction made by our model can be split into four
categories for each class:

1. A true positive (TP) is a point of a class that has been predicted correctly as such,

2. A true negative (TN) is a point not belonging to the concerned class that has been predicted correctly (e.g.,
a magnetosheath point that has not been predicted as a magnetosphere point when considering the magnetospheric case).

3. A false negative (FN) is a point of a class that has not been correctly predicted as such (e.g., a magnetosphere
point that has been predicted as a Magnetosheath point).

4. A false positive (FP) is a point not belonging to the concerned class that has been predicted as belonging to
the class (e.g., a Magnetosheath point that has been predicted as a magnetosphere point when considering the
magnetospheric case).

With these four categories, we can define the true positive rate TPR as the ratio between the number of TPs over
the total number of expected positives points:

Nrps

TPR= —cKx“
Nrps + Nens

(1)
The false positive rate FPR is defined as the ratio between the number of FNs over the total number of expected
negative points:

Neps

FPR= ————
Nees + Nons

(2)
An ideal model would be a model without any FN or FP. In this case, we would then expect the TPR to be equal to
1 and the FPR to be equal to O for the three classes. These two values are obtained for a given decision threshold
based on the predicted probability as explained in the previous subsection. We show the value of the FPR and
the TPR obtained for the generic decision threshold of 0.5 in 1. For each classes, the high TPR and the low FPR
give a first indication on the actual efficiency of our model. Logically, low decision thresholds would imply more
points predicted as belonging to a certain class and then raise both FPR and TPR. By contrast, higher decision
thresholds would decrease the number of positive points and thus decrease the FPR and the TPR.

The evolution of the TPR as a function of the FPR for continuously varying decision threshold can be represented
as the Receiving Operator Curve (ROC) shown in Figure 3 for the three classes. As expected, we notice an increasing TPR with an increasing FPR. The main interest in this curve stands in the inflexion point that correspond
to the best compromise we can find between low FPR and high TPR. We want this point to be as close to the
top left of each curve as possible as this would imply a FPR close to 0 and a TPR close to 1. A random classifier
would, for each decision threshold, increase the TPR and FPR by the same amount and the associated ROC curve
would then be a straight line of slope 1 as shown with the black dashed lines of Figure 3.

The quality of the ROC can be quantified by computing the area under curve (AUC) of each of the ROCs and
we then expect this AUC to be as close to 1 as possible. To ensure the independence of the result from the split
we made between training and test set, we trained and predicted our model 10 times for 10 different splits and
computed the AUC. The average AUC we obtained for each class is shown on the first row of Table 1. At first,
the high AUC obtained for the three classes indicate how well our model perform in classifying the three regions.
Moreover, the standard deviation we obtain is lower than le — 3. This shows that our method is independent from
the split we make between our two sets.

Compared with the short required training time, this legitimates our initial choice of fitting a gradient boosting
classifier.

In addition to these metrics, we can also evaluate the efficiency of our algorithm by using the Heidke Skill Score.
The principle of this metrics and the values we obtain are presented in Appendix C

6 of 31
vrij
rwJ\
ADVANCING EARTH
AND SPACE SCIENCE

Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

Magnetosphere Magnetosheath Solar wind

Figure 3. Receiving Operator Curve (ROC) curve of our model trained and predicting on THEMIS B data in the case of a temporal split between the training set and
the test set. From left to right are represented the ROC curve concerning the magnetosphere, the magnetosheath and the solar wind. The colored point indicates the true
positive rate and the false positive rate obtained for a decision threshold of 0.5. These values are indicated in Table 1.

NGUYEN ET AL.

The manual labeling process can be an important source of prediction errors. Thus, the label can eventually contain errors that could affect the quality of our prediction and high AUC would then not indicate the classification
ability of our model but its ability to learn from an erroneous label. To figure this out, we investigate the influence
of the manual labeling in Appendix D.

5.2. Comparison With Other Algorithms

As we just saw in the previous subsections, gradient boosting performs well after a very short required training
time. This indicates that more complex algorithms such as neural networks (Breuillard et al., 2020; Olshevsky
et al., 2019) are not necessary for this classification task. However, one legitimate question could be to ask whether even lighter machine learning algorithm would perform as well. Therefore, in addition to the gradient boosting
classifier, we train and evaluate the performances of two simpler classification algorithms: a Logistic Regression
(Berkson, 1944) and a Classification Tree (Breiman et al., 1984). The FPR, TPR and AUC of both these algorithms and the one developed by Breuillard et al. (2020) and Olshevsky et al. (2019) are shown in Table 2. Even
if their performances are not exactly comparable, this because Breuillard et al. (2020) and Olshevsky et al. (2019)
considered additional classes when fitting their model, Gradient Boosting appears as being among the algorithm
that performs best on differentiating the three regions, often equaling or even overpassing the detection scores
of the Convolutional Neural Networks while requiring a much shorter training time. It is also worth noting here
that even the simplest algorithms result in fair performances already after a training phase as long as the one we
have for Gradient Boosting.

ae of the TPR, the FPR and the AUC of the ROC of Our Detection Algorithms for Different Missions
Magnetosphere Magnetosheath Solar wind

Mission FPR TPR AUC FPR TPR AUC FPR TPR AUC
THEMIS 0.0091 0.991 0.999 0.029 0.978 0.997 0.027 0.942 0.999
Cluster 1 (without retraining) 0.039 0.936 0.988 0.045 0.868 0.983 0.048 0.988 0.996
Cluster 1 (with retraining) 0.01 0.985 0.999 0.013 0.984 0.998 0.0062 0.993 0.999
Double Star TC1 (without retraining) 0.015 0.967 0.996 0.033 0.93 0.992 0.026 0.963 0.996
Double Star TC1 (with retraining) 0.093 0.987 0.999 0.013 0.984 0.998 0.025 0.983 0.999
MMS (without retraining) 0.007 0.980 0.997 0.004 0.989 0.994 0.005 0.965 0.995

ARTEMIS 0.004 0.959 0.999 0.081 0.948 0.999 0.059 0.935 0.999

Note. AUC, area under curve; FPR, false positive rate; ROC, Receiving Operator Curve; TPR, true positive rate.

7 of 31
vrij
rwJ\
ADVANCING EARTH
AND SPACE SCIENCE

Table 2

FPR, TPR, AUC and Training Time Obtained for Different Algorithms for Several Train-Test Split

Algorithm

Logistic Regression
Decision Tree
Breuillard et al. (2020)
Olshevsky et al. (2019)

Our model

Journal of Geophysical Research: Space Physics

10.1029/2021JA029773

Magnetosphere Magnetosheath Solar wind
FPR TPR AUC FPR TPR AUC FPR TPR AUC
0.003 0.979 0.998 0.017 0.885 0.954 0.049 0.933 0.937
0.026 0.986 0.976 0.037 0.923 0.937 0.023 0.781 0.881
0.006 0.949 0.999 0.015 0.912 0.999 0.008 0.918 0.999
0.017 0.983 0.022 0.978 0.016 0.984
0.009 1 0.991 0.999 0.029 0.978 0.997 0.027 0.942 0.999

Note. For each metric, the highest score is shown in bold. AUC, area under curve; FPR, false positive rate; TPR, true positive rate.

NGUYEN ET AL.

6. Adaptability

Having trained an algorithm to detect the three near-Earth regions with high reliability, we should not have difficulties to adapt it to the data provided by additional spacecraft that go through those regions. Even if a similar
work can be adapted on the numerous past missions that went through the three near-Earth regions, we focus here
on the most recent missions that offer the advantage of providing the data with the best quality, which removes
an additional complexity that would appear with older missions.

To do so, we label data points of each of the missions we are working on and compare this label to the predictions
of our model trained with THEMIS data.

6.1. Double Star

We use the data of the TC1 spacecraft on the whole mission period (between the Ist of January 2004 and the Ist
of january 2008) The magnetic field data are provided by the Fluxgate Magnetometer (Carr et al., 2005) with a
temporal resolution of 2s. The plasma moments are provided by the CIS-HIA instrument (Fazakerley et al., 2005)
with a temporal resolution of 4s. Just like for the THEMIS data set, we resampled the data to a 1 min resolution.

A typical representation of the data is shown in Figure 4.

Here the part of the data we labeled is made of 20,671 magnetosphere points, 23,091 magnetosheath points and
4,944 solar wind points taken at the beginning of the year 2005. The main reason explaining the noticed imbalance in the data stands in the orbit of TC1 itself that is not supposed to cross the bow shock.

The spatial distribution of our labeled data is also shown in Appendix A.

Since Double Star also has an equatorial orbit, we expect the model trained on THEMIS to perform well even
without having to be retrained and this is the main reason why our label does not have to provide an entire coverage of the (X-Z) plane. And this is confirmed by the high AUC, HSS, FPR, and TPR we have in Tables | and the
comparison of the HSS obtained for the different missions shown in Table Cl.

Refitting the model would then allow a finer detection that would be specific to the quality of the data provided
by Double Star in comparison to the THEMIS data but can be skipped as it does not bring a significant gain in
AUC, FPR and TPR according to Table 1.

6.2. MMS

We used the data of the MMS | spacecraft between September 2015 and July 2019. The magnetic field data
were provided by the Fluxgate Magnetometer (Russell et al., 2016) with a temporal resolution of 4.5s. The plasma moments were provided by the Fast-survey mode of the Fast Plasma Investigation instrument (FPI, Pollock
et al., 2016) with a temporal resolution of 4.5s. Just like THEMIS, the data were resampled to a 1 min resolution.

A typical representation of the data is shown in Figure 5.

8 of 31
EG
ADVANCING EARTH
AND SPACE SCIENCE

¢

10!

\V(km/s) B (nT) N,(cm~*)

lons energy (eV)

Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

02:00

02:00

02:00

05:00 08:00 11:00 14:00

05:00 08:00 11:00 14:00

05:00 08:00 11:00 14:00

[eV/(cm?-s-sr-eV)]

05:00 08:00 11:00 14:00

— Prediction

05:00 08:00 11:00 14:00

Figure 4. In situ measurement provided by Double Star TC1 spacecraft on the Ist of January 2005. The legend is the same than in Figure 1.

NGUYEN ET AL.

Since MMS also has an equatorial orbit, we once again expect the model trained on THEMIS to provide a
very good classification of the three regions on MMS data as for the case of what has been shown for Double
Star.

To figure it out, we label 7,612 magnetosphere points, 19,272 magnetosheath points and 3,651 solar wind points
during the first year of MMS and these labels the associated prediction of the classifier. The spatial coverage of
these labeled points is shown in Figure A2.

The high metrics shown in Tables | and Cl confirms the adaptability of our classifier to equatorial missions
without further additional fitting.

9 of 31
Arr ; °
dened Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

ADVANCING EARTH
AND SPACE SCIENCE

N,(cm~?)

Lj
10!
10°
107!

23:00:00 02:00:00

B (nT)

23:00:00 02:00:00

V(km/s)

23:00:00 02:00:00
4
> irae
= 3
5 10? 10° Mi
ro) ”
o 2
c 104 *
® 102 jz
na =
S 102 >
i+]
2 10! ~
23:00:00 02:00:00 10°

—— Label
— Prediction

WAL La

23:00:00 02:00:00

Figure 5. In situ measurement provided by MMS spacecraft on the 31st of December 2015. The legend is the same than in Figure 1.

6.3. Cluster

We use the available data from Cluster 1 spacecraft between the 1 January 2001 and the 1 January 2013 and
from Cluster 3 spacecraft between the | January 2001 and the 1 December 2009. The magnetic field data
are provided by the Fluxgate Magnetometer with a temporal resolution of 4s (Balogh et al., 2001). The plasma moments are provided by the Hot Ion Analyzer instrument (Reme et al., 2001) when the instrument is
working under the magnetosphere or the magnetosheath mode. Here again, the data is resampled to a 1 min
resolution.

In comparison with Double Star and MMS, this case might be more challenging because of the orbit, here polar,
and the regions visited that have different physical properties than the one visited by equatorial missions. The
data provided by THEMIS and Cluster can therefore be substantially different and there is no real clue on how an
algorithm trained on equatorial orbit data would perform on predicting on polar orbit data.

One minute sampled Cluster data are shown in Figure 6 and we here label 50,277 points of magnetosphere, 76,468
points of magnetosheath and 22,017 of solar wind between the years 2005 and 2006 which spatial distribution
is shown in Figure A3. Those two years will constitute the time period on which we will test the adaptability of

NGUYEN ET AL. 10 of 31
[Ves

AY Journal of Geophysical Research: Space Physics 10.1029/2021JA029773
a 10+
£
1S)
= 10°
10-}
11:00 14:00 17:00

Bz

B (nT)
ee oy gy
| | |

2g

11:00 14:00 17:00
200
¢ 9 :
= 200 c
S — Z
—400
~~ 108
> 104 =
© ro
10° 3
5} 10° 5
S 10!
a) 102 &
U
WY =
6 10? 2
™~ 40} ; LX
11:00 14:00 17:00 10°

—— Label
— Prediction

11:00 14:00 17:00

Figure 6. In situ measurement provided by Cluster 1 spacecraft on the 6th of February 2005. The legend is the same than in Figure 1.

the region classifier. One third of these labeled points are used to evaluate the performances of the models while
we kept the remaining two thirds in the case refitting the algorithm is needed. Applying our THEMIS-trained
model, we notice a lower AUC, TPR and FPR for each of the three classes, especially for the magnetosheath. This
indicates the difficulties the classifier has to adapt to polar orbit data.

We then adapt our classifier to the polar case by refitting the model trained on THEMIS with the Cluster labels.
The increasing metrics we obtained, shown in Table | and the associated high HSS also shown in C1 proves the
necessity we had to adapt our algorithm to the specificity of the Cluster data. It also shows our model can be easily adapted to the data of another mission, exploring regions with significant statistical deviations of the features,
after a small labeling and refitting phase.

NGUYEN ET AL. 11 of 31
Art jI . .
nw Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

ADVANCING EARTH
AND SPACE SCIENCE

6.4. ARTEMIS

The mission ARTEMIS actually corresponds to the THEMIS B and C spacecraft when they were moved from a
terrestrial to a lunar orbit at the end of 2009. The data we used in this case are then the one provided by the same
THEMIS B instruments than in Section 2 between the | January 2010 and the | June 2019.

The orbit of the ARTEMIS spacecraft is different from the orbit of the mission we have been investigating so far.
This difference comes with a lot of change in the nature of the data measured by the spacecraft.

First of all, the spacecraft orbit the moon and are much farther (around 60 Re) from the Earth than the spacecraft
of the other missions we have used. This implies the spacecraft does not explore the dayside regions and crosses
the magnetopause and the bow shock in the nightside. At these distances, the magnetosheath plasma becomes
almost as fast and as tenuous as the solar wind and small magnetosheath fluctuations could easily be confused
with either a magnetopause or a bow shock crossing.

a 10!
£
U
“= 0
= 10
107!
19:00 22:00
50
25

B (nT)
| | |
Nn

19:00 22:00

V(km/s)

19:00 22:00

~ ~
3
[eV/(cm?-s-sr-eV)]

lons energy (eV)

—— Label
— Prediction

19:00 22:00

Figure 7. In situ measurement provided by the ARTEMIS B spacecraft on the 13th of August 2016. The legend is the same than in Figure 1.

NGUYEN ET AL. 12 of 31
vrij
rid
ADVANCING EARTH
AND SPACE SCIENCE

NGUYEN ET AL.

Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

Second, the spacecraft spend most of their time in the solar wind, which may make statistical properties of their measurements more sensitive to the data variability induced by the solar cycle that we neglected for the previous missions.

Finally, this specific type of orbit also introduces time intervals during which the data does not take values statistically close to any of our regions of interest. Indeed, once per orbit, ARTEMIS explores the lunar wake, characterized by an extremely low density and fluctuating velocity in many directions. These intervals, for which a typical
representation of the data is shown in Figure 7, cannot be considered to belong to any of our existing region classes.

For these three reasons, the method we presented in the previous sections and successfully adapted to Double
Star, MMS and Cluster cannot be used as is and the entire process from the labeling to the choice of the feature
has to be designed from scratch.

To cope with the variability induced by the solar cycle we label a month per year. We furthermore add the lunar
wake as a fourth explored region (with an associated value of 3). The final labeled data set is made of 26,560
magnetosphere points, 131,656 magnetosheath points, 429,283 solar wind points and 15,070 points of lunar wake
which spatial distribution is shown in Figure A4.

We cope with the increasing difficulty to distinguish magnetosheath and solar wind by adding the spacecraft
GSM coordinates as a feature of the data set which will then consist in 11 input variables.

Having a different data set and a different number of classes, we here cannot use the model trained in the previous
section and we will then focus on the specific model we trained for this mission. The resulting high metrics shown
in Table | shows the gradient boosting also performs well in a significantly different region and with more classes. This especially confirmed with the AUC and the HSS we found for the lunar wake region, that we respectively
found equal to 0.97 and 0.947.

7. Comparison With Manually Set Thresholds

Having shown the efficiency of gradient boosting on different missions. Additional prediction examples can be
found in Appendix E, we want to compare it to the state of the art non-learning methods such as the one elaborated by Jelinek et al. (2012) that we described in the introduction.

Figure 8 represents the 2D histogram of B and N,, for THEMIS B, Double Star and Cluster | on the periods on
which we labeled the different associated datasets. We divided these parameters by the corresponding solar wind
density and the IMF amplitude that we obtained from the OMNI data shifted from the actual measurement time
using the two-step propagation algorithm described in Safrankova et al. (2002). At first sight, one can easily
distinguish three main regions that are separated with the solid red lines for the three missions. Nevertheless,
these linear boundaries have been set manually and we cannot ensure these could be the best choice for the three
missions. To evaluate the quality of the classification, we compute the TPR and the FPR for the three missions
and for varying boundary lines. We then use these values to compute the AUCs that are shown in Table 3.

Once again, we notice a lower AUC in the case of Cluster which is consistent with the difference we have between
equatorial and polar orbits as explained in the previous section. Additionally, even if the boundaries plotted in
Figure 8 seem to provide a decent separation between the three regions, the AUC is lower than the one we obtained with the gradient boosting. This indicates our model performs better in classifying the three regions by
setting more flexible boundaries on supplementary features while requiring less fitting time than the one required
to manually set the thresholds used in Figure 8.

The same kind of histogram gets messier with a much less obvious transition from the magnetosheath to the solar wind
and the addition of the moon's wake as shown with the ARTEMIS data in Figure 9. This shows the difficulty manually
set thresholds would have for far night side oriented missions and the interest of using machine learning in this case.

8. Massive Detection of Boundary Crossings

In the previous sections, we have shown the efficiency, the reliability and the adaptability of our classifiers on
data from several missions and spacecraft. From now on, these classifiers can be used to elaborate our magnetopause and bow shock crossings catalogs by classifying the in situ data provided by any near-Earth spacecraft

13 of 31
A” : ,
dened Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

ADVANCING EARTH
AND SPACE SCIENCE

' I. hy a
ees

re.
1
s
re 4°
“ew
Tr
s
.

Np/Nomni

104

10°

Np/Nomm Np/Nommi

Figure 8. Two-dimensional histogram of B and N, divided by the corresponding OMNI data for the three missions: THEMIS B (left), Cluster 1 (middle), and Double
Star TC1 (right). The solid red lines indicate a possible set of linear boundaries we could define to separate the three regions.

Table 3

AUC for the Threshold-Based Method
AUC

Mission magnetosphere

THEMIS B 0.915

Cluster 1 0.897

Double Star TC1 0.913

Note. AUC, area under curve.

NGUYEN ET AL.

and by selecting time intervals enclosing two predicted regions. To do so, we train our three different models,
THEMIS, Cluster, and ARTEMIS on their whole labeled datasets. Those trained models can be found at https://
doi.org/10.5281/zenodo.5668298. In the following, these models will be respectively named the equatorial,
high-latitude and lunar models.

In addition to the performances on the labeled data set of the different missions in use in this study, shown in the
previous sections, we make sure the massive prediction of the three models are consistent with the labeled data
by comparing the physical characteristics of the classified and the labeled data points of each regions. Figure 10
compares the average prediction of the three different models to their associated average training label for each
bin of the (V_, B) plane.

At first, the binned average of the labels, shown in the right column exhibits three main zones where there is
almost no doubt on the region visited by the spacecraft. The transition from a zone to another appears as a zone
where the label is transient consistently with what is expected for the crossing of one of the near-Earth boundaries. It is worth noting that the transitions between the different colored regions are far from being linear and this
is even more true when we look at the distributions for the polar and lunar models. Following the discussion of
Section 7, this confirms the limits of an automatic detection method based on the manual setting of thresholds
on the densities and magnetic field amplitudes and give a further support in favor of the application of machine
learning for such classification task.

Despite an expected increased noise, the pattern in the left column is similar to the one in the right column. This
suggests that the massive prediction obtained from the equatorial, the polar and the lunar model is consistent with
our labeled data. For both the equatorial and the polar model, we notice bins at low densities for which the average
prediction is rather equal to magnetosheath or solar wind than magnetosphere. This indicate the presence of low
density datapoints that have either been classified as magnetosheath or magnetosphere. However, these bins all
contain less than 100 datapoints and are actually within the margin of error of our model.

8.1. Magnetopause Catalog

We then elaborate a complete magnetopause crossing catalog by running
the THEMIS classifier on the data provided by THEMIS A, B, C, D, and E

AUC AUC sol Tr ‘ ; ;
oe spacecraft. To gain time in the construction of the crossings and because we
magnetosheath wind
do not expect any magnetopause crossing in the nightside operation phase,
0.908 0.859 we restrict ourselves to the dayside, dawn and dusk operation phase. As no
0.852 0.828 crossing is expected far away in the solar wind or close to the Earth dipole,
0.894 0.843 we also only the parts of the spacecraft orbit that were less than 5 Re away

from the magnetopause distance predicted by Lin et al. (2010) for a dynamic

14 of 31
fri
AGU

ADVANCING EARTH
AND SPACE SCIENCE

Table 4

Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

B/Bomni

0.0 0.5

1.0 Last 2.0 25 3.0
Np/Nomni

Figure 9. Two-dimensional histogram of B and N,, divided by the corresponding OMNI data for ARTEMIS B.

pressure of 2 nPa and a null IMF B.. The raw predictions of the classifier are then smoothed by applying a median
filter with a window size of 3 min. We then define a magnetopause crossing as a | hr interval that contains as
many magnetosheath points as magnetosphere points making sure every detected events were disjoints.

The same model is used on the in situ data provided by Double Star between 2004 and 2007 and MMS between
2015 and 2020.

We finally apply the same process on the in situ data provided by Cluster | on the 2001—2013 period, by Cluster
3 on the 2001-2009 period and on ARTEMIS between 2010 and 2019 by using the corresponding trained model.
The total number of crossings we obtained are summarized in Table 4. All of the magnetopause lists can be found
online at https://doi.org/10.528 1/zenodo.5668298.

Our detection method has been evaluated on regions where the spacecraft is not expected to cross a boundary. In
these regions, the algorithm is less likely to hesitate on its prediction. On the other hand, it is more probable it
hesitates on the predictions made close to the boundaries. Consequently, we have to ensure the classification is

still of decent quality there.

Number of Magnetopause and Bow Shock Crossings We Have for Different

Missions
Mission
THEMIS A
THEMIS B
THEMIS C
THEMIS D
THEMIS E
Cluster 1
Cluster 3
Double Star TC1
MMS 1
ARTEMIS B
ARTEMIS C
Total

NGUYEN ET AL.

Magnetopause crossings

Bow shock crossings

Figure 11 represents the ROC we have on the classification between magnetosphere and magnetosheath points for THEMIS B, Cluster 1 and Double Star
for the subset of our test set that lies in the proximity of a magnetopause or
shock crossing. These predictions have been obtained with a model that has
been trained with the complement part of the data set, that is, the subset that
excludes the proximity of the crossings. The obtained AUC is here lower than

2,822 1,590 the one presented in the previous sections. This can be explained by the fact,
376 1,030 the manual labels made in this region is more ambiguous than the one made
670 1.238 in the parts of orbit that are far from one of the boundaries, resulting in a more

hesitant classifier. The AUC value is still high enough to ensure the good quali
2,705 1,920 ty of the classification when a spacecraft arrives close to the magnetopause and

2,738 1,511 thus our capacity of building crossings from the prediction made by our model.

1782 3229 We then computed the mean probability of each crossing by averaging the prob
see oe abilities of belonging to the predicted class of each point present in the crossing.
one ome Events with high probability would correspond to undoubtful crossings while

the events with the lowest probability would be less likely to be actual cross
215 1,602 ings. The probability distribution of our 15,062 events is shown in Figure 12.

487 1,626 Having a high probability for the greatest part of our events then ensures the
15,062 17,227 consistency of our magnetopause list.

15 of 31
Avni |
rid
ADVANCING EARTH
AND SPACE SCIENCE

Journal of Geophysical Research: Space Physics

10.1029/2021JA029773

Prediction Label
10° 10°
Equatorial Orbits 102 10? Solar wind
102 10+
faa
s&s i0° = ig
m m
7 ee 107}
1072 io
10° '10- 107* 10° 10+ 10* 10° 10-* 10+ 107* 10° 10+ i0* I0Np (cm-3) Np (cm~>)
107 107
Polar Orbits 107 10?
10? 10°
PS 0 Ee 0
= 10 = 10 Magnetosheath
mM al
107} 10
10 19
107° 10°? 107+ 10° 107 107 10° 10> 10° 10"* 30° 107 io? io°
Np (cm-3) Np (cm->)
107 107
Lunar Orbits 10?
10?
LL.
= 10°
mM
107}
i
Magnetosphere
10-° 10°-* 107+ 10° i0* 107 10° 19°" 10-7 107* 10° 10* 07 10°
Np (cm-3) Np (cm~>)

Figure 10. Binned average of the massive prediction (left column) and the training label (right column) of the equatorial (first row), the polar (second row) and the
lunar (third row) models projected in the (W,, B) plane.

NGUYEN ET AL.

Finally, the spatial distributions of the crossings that have a probability higher than 75% in the GSM XZ, XY,
and YZ planes is shown in Figure 13. These crossings represent 98.5% of the crossings built with our models and
are then expected to be the most likely to be actual magnetopause crossings. The solid black lines represent the
position of the magnetopause model established by (Lin et al., 2010) and computed for a dynamic pressure of
2 nPa, a null B, and assuming no dipole-tilt. The proximity between this distance and our actual crossings ends
up proving the capacity our method has to elaborate a magnetopause crossings catalog with a decent coverage of
the surface at different latitudes and longitudes.

8.2. Bow Shock Catalog

We define a bow shock crossing event as 10 min interval that contains as much magnetosheath points as solar
wind points. We then run the models we trained for the different missions detailed in Section 3 on the same data

16 of 31
Arr ; °
dened Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

ADVANCING EARTH
AND SPACE SCIENCE

TPR

THEMIS B, FPR=0.055
THEMIS B, TPR=0.945
THEMIS B, AUC=0.985

FPR

TPR

THEMIS B, FPR=0.079
THEMIS B, TPR=0.921
THEMIS B, AUC=0.955

FPR

Cluster 1, FPR=0.088
Cluster 1, TPR=0.937
Cluster 1, AUC=0.976

DoubleStar, FPR=0.051
DoubleStar, TPR=0.947
DoubleStar, AUC=0.989

FPR

Cluster 1, FPR=0.083
Cluster 1, TPR=0.904
Cluster 1, AUC=0.965

DoubleStar, FPR=0.056
DoubleStar, TPR=0.924
Doublestar, AUC=0.976

FPR

oc
ae
THEMIS B, FPR=0.041 Cluster 1, FPR=0.021 DoubleStar, FPR=0.018
THEMIS B, TPR=0.944 Cluster 1, TPR=0.979 DoubleStar, TPR=0.982
THEMIS B, AUC=0.986 Cluster 1, AUC=0.994 Doublestar, AUC=0.996
0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
FPR FPR FPR

Figure 11. Receiving Operator Curve curves evaluated on the labeled crossings for the three missions THEMIS B (left), Cluster 1 (middle) and Double Star (right) for
the three classes: magnetosphere (top), magnetosheath (middle) and solar wind (bottom). The indicated true positive rate and the false positive rate have heen obtained

for a decision threshold of 0.5, which corresponds to the colored dot in each panel.

103
WY)
(@))
Cc
iT;
WY
© 102
O
ue
oO
=
cD)
2 10!
=
J
=

10°

0.5 0.6 0.7 0.8 0.9 1.0
Probability

Figure 12. Distribution of the probability of the 15,062 magnetopause
crossings we built and summarized in Table 4. The solid dashed line represent
the probability threshold we chose for Figure 13.

NGUYEN ET AL.

set we used to elaborate the magnetopause crossing catalog. The total number
of obtained crossings is once again summarized in Table 4 and the bow shock
lists can once again be found at https://doi.org/10.528 1/zenodo.5668298.

The spatial distribution of the crossings with a probability higher than 75%
in the GSM XZ, XY and YZ planes is shown in Figure 15. The solid black
line here represents the location of the Jefab et al. (2005) bow shock model
computed for a dynamic pressure of 2 nPa, a null B, and an Alfven Mach of 8.

9. Conclusion

Using a Gradient Boosting Classifier, we established an automatic detection method of the different near-Earth regions as observed by the THEMIS
spacecraft during the dawn, dusk and dayside mission phases. This method was successfully adapted on other equatorial dayside missions (Double
Star and MMS) and, after a small retraining phase necessary to consider the

17 of 31
Avni |
rid
ADVANCING EARTH
AND SPACE SCIENCE

Y (Re)

—60

~40

Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

—20
X (Re)

Z (Re)
Z (Re)
ee |

—20
0 —60 —40 —20 0 -30 -20 -10
X (Re) Y (Re)

Figure 13. Spatial distribution of the crossings above the threshold in Figure 12 in the XY (left), XZ (middle), YZ (right) GSM planes. The solid black line indicate the
Lin et al. (2010) magnetopause model with a dynamic pressure of 2 nPa and a null B..

104

103

10?

10!

Number of Crossings

10°
0.5

Figure 14. Distribution of the probability of the 17,227 bow shock crossings
we built and summarized in Table 4. The solid dashed line represent the
probability threshold we chose for Figure 15.

NGUYEN ET AL.

0.6

0.7

orbital differences between different missions, was also successful on non-equatorial dayside missions such as
Cluster. The adaptability of the method has even been tested on missions with a substantially different orbit such
as ARTEMIS for which we provided a successful region classification after a small redesign of the observed
features, implying the addition of the spacecraft GSM position, and the way the label was made, by considering
an additional region with the lunar wake. Having proved this adaptability, we may also think of using the data of
additional near-Earth missions, such as WIND, Geotail, Hawkeye, Polar or Interball, provided enough information about the plasma moments with a sufficient resolution is provided.

For every mission we considered, our method outperformed the quality of the detection provided by manually set
thresholds and reached similar AUC, FPR and TPR values as the one achieved by neural networks based methods
(Breuillard et al., 2020; Olshevsky et al., 2019), with the advantage of being much faster to train. Using the plasma moments paved the way to an easy adaptability from a specific type of mission to another and the production
of light-weight algorithms that could eventually be taken onboard of upcoming missions to automatically select
the data of interest and thus automatically decide the data that should be stored (and at which resolution) for
further analysis. This would allow a significant gain in time regarding the data selection process that are either
threshold triggered or human monitored like the Scientist In The Loop process in charge of the manual selection
of MMS data. Moreover, the method does not use the specificity of being in the near-Earth environment and
could also be adapted to other planetary missions in the solar system.

For simplification, we only considered three classes and defined as magnetosheath any region where plasma
differed from pristine solar wind and magnetospheric ones. The classification could be enhanced by the consideration of additional regions depending on the scientific objectives.

We used this method to elaborate one of the most exhaustive public magnetopause and bow shock crossing catalogs to our knowledge. A bonus to
our method is that these catalogs can be readily and automatically grown
as new data are made available. Having a large list of events also gives the
opportunity to study these two near-Earth boundaries and physical processes occurring in their vicinity, from a statistical point of view. One could
especially think of exploiting the magnetopause crossings to provide an
automatic detection method of the typical in situ signature of accelerated
plasma flow induced by magnetic reconnection, which will be the topic of
a forthcoming study.

Last but not least, the fast and reproducible of one of the most exhaustive
0.8 0.9 1.0 existing boundary crossings catalogs is the preamble for the massive statis
Probability tical analysis of the position of both the magnetopause and the bow shock

for various solar wind and seasonal conditions. In the specific case of the
magnetopause, this is the purpose to the three companion papers of this study
(Nguyen et al., 2022a, 2022b, 2022c).

18 of 31
Arr : °
AIL Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

ADVANCING EARTH
AND SPACE SCIENCE

10?

10°
=—I2 —50 =—Z5 O 25 50

X (Re) X (Re) Y (Re)

Figure 15. Spatial distribution of the crossings above the threshold in Figure 14 in the XY (left), XZ (middle), YZ (right) GSM planes. The solid black line indicate the
Jerab et al. (2005) bow shock model with a dynamic pressure of 2 nPa, a null B, and an Alfven Mach of 8.

Appendix A: Spatial Distribution of the Different Labeled Datasets

In this section, we represent the spatial distribution of the labeled data set of Double Star (Figure Al), MMS
(Figure A2), Cluster (Figure A3), and ARTEMIS (Figure A4).

2 10? 2
= £
(o) (oe)
Q. ©.
© ©
—) oS)
© o
xo) wT
— —
° °o
© o
2 10°96
= =
=> =a |
- =z
10°

Number of data points

10°

26 <5 =10 <5 6
Xcesm(Re)

5 10 15

Figure Al. Spatial coverage of the Double Star labeled data set. The legend is the same than in Figure 2.

NGUYEN ET AL. 19 of 31
Arr ; °
mI Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

ADVANCING EARTH
AND SPACE SCIENCE

~
oO
Nw

Yesm(Re)
Yesm(Re)

Number of data points
Number of data points

~
oO
~

103
Ww
~~
—
oO
Qa.
@O 102 5
= s
a Ss
~ eS
Vv
He |
£
>
10:=

5 10 15

0
Xesm(Re)

Figure A2. Spatial coverage of the MMS labeled data set. The legend is the same than in Figure 2.

NGUYEN ET AL. 20 of 31
Arr : °
AIL Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

ADVANCING EARTH
AND SPACE SCIENCE

10?
102
Ww
=)
—
10? 4
oO
~~
o
wT
Vee
°o
10? ©
f<))
©
10? £
ee |
zm
10° 10°

~
oO
iS)

°
Number of data points

Xesm(Re)

Figure A3. Spatial coverage of the Cluster labeled data set. The legend is the same than in Figure 2.

NGUYEN ET AL. 21 ti ol
Arr ; °
dened Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

ADVANCING EARTH
AND SPACE SCIENCE

22 4
10"'< <
(oe) (o)
Q. Q.
g 2 @ 2
cc oS e
® 6 & 6
= 5 = 15
10! .a a
£ =
= | sacs |
os =

10° 10°

102
10? » wn
p=) p=)
< =
(o) Oo
Q. ©.
oO ©
~~ - =)
o ©
wT TT
S 10: ‘S
1o ©
10° & b
£ =
=> >
zm =

10° 10°

-60 —40 —20 0 20 —60 —40 =30 0 20
Xesm(Re) Xcesm(Re)

Figure A4. Spatial coverage of the ARTMIS labeled data set. The legend is the same than in Figure 2 with the addition of
the Moon's wake bins in purple which vary between 1 and 157.

Appendix B: Probability Calibration of the Model

A well calibrated classifier is a classifier for which the probabilistic output gives a correct representation of the
data seen by the algorithm. For instance, we expect 50% of the points predicted with a probability of 50% to be
actual positives (either TP or FN). This verification is necessary as soon as the probabilistic output of a model
is at stake. Nevertheless, boosted algorithms such as gradient boosting are known to have calibration issues
(Niculescu-Mizil & Caruana, 2005). We then have to ensure our model is well-calibrated before using its probabilistic output in the way we did it in Section 5. To do so, we plot the Calibration curve shown in Figure B1 that
represents the evolution of the fraction of actual positive in our test set for each probability bin. For a perfectly
calibrated classifier, the calibration curves should be linear and stick to the black dashed line for the three classes.
Having a linear calibration curve close enough to the perfect calibration curve for the three regions, we consider
the probabilistic output of our model to be decently well-calibrated.

NGUYEN ET AL. 22 of 31
vrij
rid
ADVANCING EARTH
AND SPACE SCIENCE

1.0
0.9

0.8

HSS

0.7

0.6

0.5
0.0

Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

1.0 perfectly calibrated

” MSP
s 0.8 MSH
= SW
O

=4 0.6

uw

eo)

c 0.4

Oo

=

U

ji 0.2

~
o>)

0.0 0.2 0.4 0.6 0.8 1.0
Mean predicted probability

Figure B1. Calibration curve of our model trained on THEMIS data for the three regions. The black dashed line represent
the calibration a perfectly calibrated classifier would have.

Appendix C: Heidke Skill Score

The Heidke Skill Score HSS is a metric that compares the performance of our algorithm to what would come
from a random classifier:

Nrps + Norns _ (Nrps + Newns)*\Nrps + Neps)t} Nen + Nrwns)*Nep_ + Norn)
N N2
HSS = 2S7$J4JH___"__—_"_—S_] J (Cl)
1— Nrps_ + Nens)*\Nrps + Neps)+}\Nen + Nrns)*Nep_ + Nr)
N2

where N denotes the total number of points on which the prediction was lead. A negative HSS indicates
randomness performs better than the classifier while a perfect forecast would be associated to a HSS of 1.
The Evolution of the HSS for varying probabilistic decision threshold is shown in Figure Cl. The high value
reached by the HSS for each class for a wide range of decision thresholds confirms the efficiency of our model.
Finding decreasing HSS for high decision threshold is not surprising as the number of FN will slightly increase
in this case. The main interest in this curve then stands in the value of the HSS we do find for the decision
threshold we set for our prediction, that is to say 0.5. The value of the HSS we have in this case is shown in
Table C1 and finding it pretty close to 1 indicates how well our model performs in the classification of the
three regions.

Magnetosphere 10 Magnetosheath Lo Solar Wind

0.9 0.9

0.8 0.8

0.7 0.7

0.6 0.6

0.5 0.5
0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0
Decision threshold Decision threshold Decision threshold

Figure C1. Evolution of the Heidke Skill Score (HSS) as a function of the decision threshold for our model trained on THEMIS data for a temporal split. From left to
right are represented the HSS curve concerning the magnetosphere, the magnetosheath, and the solar wind.

NGUYEN ET AL.

23 of 31
vrij
rid
ADVANCING EARTH
AND SPACE SCIENCE

10

0.0

0.1

Journal of Geophysical Research: Space Physics 10.1029/2021JA029773
Table C1
Comparison of the HSS of Our Detection Algorithms for Different Missions
Mission HSS magnetosphere HSS magnetosheath HSS solar wind
THEMIS B 0.987 0.975 0.993
Cluster | 0.976 0.972 0.981
Double Star TC1 0.980 0.974 0.983
MMS 0.982 0.973 0.987
Artemis 0.976 0.962 0.974

Note. HSS, Heidke Skill Score.

Appendix D: Influence of the Manual Labeling

To investigate the influence of the manual labeling on the performances, we perform trainings and evaluations
of the algorithm by voluntarily mislabeling an ever-growing percentage of the data set. If our model completely
follows the indicated label in the training set, we expect a high AUC whatever this percentage might be. The
mislabeling process is done as follows:

1. We select a fraction of random points in the data set.
2. The magnetosphere and the solar wind points are labeled as magnetosheath points.
3. Magnetosheath points are randomly mislabeled between the two other classes.

The main reason that justifies this process stands in the fact that a human observer will never confuse magnetosphere and solar wind and and the fact there is of course some ambiguity in the labeling for classes concerned
with a physical interface, where data points do not strictly belong to either one or the other but rather represent
the finite transition region, omitted in our model. We repeat the process for an ever growing percentage of
the data set until the proportion of the mislabeled points reaches 50% of the data set. The random mislabeling
and associated training and AUC computation are repeated 10 times at each step. The evolution of the AUC
with the mislabeling proportion is shown in Figure D1 for the three classes of the THEMIS data set. The gray
dashed lines represent the standard deviation we have between the different iterations of a given percentage
of mislabeling.

Magnetosphere - Magnetosheath Solar Wind

0.2

0.3

0.4 0.5 0.0 0.1 0.2 0.3 0.4 0.5 ~ 0.0 0.1 0.2 0.3 0.4 0.5

Percentage of global mislabelling Percentage of global mislabelling Percentage of global mislabelling

Figure D1. Evolution of the area under curve (AUC) as a function of the mislabeling ratio for the three different classes: magnetosphere (blue), magnetosheath (red),
and solar wind (green). The gray dashed line represent the standard deviation we have between the different AUC scores of a same mislabeling percentage.

NGUYEN ET AL.

24 of 31
vrij
rid
ADVANCING EARTH
AND SPACE SCIENCE

a 10!
&
Rid
a 0
= 10
107!

V(km/s) B (nT)

lons energy (eV)

Prediction

0.0

Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

17:00

17:00

17:00

17:00

17:00

Having a more significant drop in the performances for the magnetosheath is not surprising as this is the class
that will be most affected by our mislabeling process. Noticing that drop for the three different classes proves the
model does not simply follow the indications provided from the labels but tries to find an intrinsic difference in
the physical parameters of the three classes.

This shows the real capacity of our algorithm to classify the three near-Earth regions as well as the reliability of
our label.

Appendix E: Additional Detection Examples

In this section, we show additional detection examples of the region classifier on the data of THEMIS B (Figure El), Double Star (Figure E2), MMS (Figure E3), Cluster (Figure E4) and ARTEMIS (Figure E5).

20:00 23:00 02:00

20:00 23:00 02:00

20:00 23:00 02:00

— =) ~
© © oO
—_ oO oo
[eV/(cm?-s-sr-eV)]

)
i)
i)

20:00 23:00 02:00

~
om |
°o

20:00 23:00 02:00

Figure E1. In situ measurement provided by THEMIS B spacecraft on the 10th of November 2008. The legend is the same than in Figure 1.

NGUYEN ET AL.

25 of 31
Ast it ‘ 0
NWI Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

ADVANCING EARTH
AND SPACE SCIENCE

N,(cm-?)

B (nT)

V(km/s)

09:00 12:00 15:00 18:00
S =
wv s
— wv
— w
jo "
=
D i
@ E
pL =
= >
2 a
09:00 12:00 15:00 18:00
|
2
Ww
Y
o
&

Figure E2. In situ measurement provided by Double Star TC 1 spacecraft on the 15th of January 2005. The legend is the same than in Figure 1.

NGUYEN ET AL. 26 of 31
[Ves

AY Journal of Geophysical Research: Space Physics 10.1029/2021JA029773
a 10!
z
~ 0
> 10
107}
09:00:00 12:00:00

B (nT)

09:00:00 12:00:00

V(km/s)

09:00:00 12:00:00
atts 10® _
@ a
2 i
= 104 ¢
U
1 —
6 102 3
09:00:00 12:00:00 10°
2.0
cc
Oo 15
+
1
3 1.0
os 0.5
0.0
09:00:00 12:00:00

Figure E3. In situ measurement provided by MMS | spacecraft on the 2nd of December 2015. The legend is the same than in Figure 1.

NGUYEN ET AL. 27 of 31
AND SPACE SCIENCE

a 10!

£

U |

a NA WOM TI
10-1 J Wh ‘t

V(km/s) B (nT)

lons energy (eV)

Prediction

Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

Pa Bes l AS
16:00 19:00 22:00 01:00 04:00 07:00 10:00 13:00 16:00 19:00

16:00 19:00 22:00 01:00 04:00 07:00 10:00 13:00 16:00 19:00

16:00 19:00 22:00 01:00 04:00 07:00 10:00 13:00 16:00 19:00
‘a4 | 10°
63
103 6
~
10° %
10? S
10? =
10! ; ; : : ’ —

16:00 19:00 22:00 01:00 04:00 07:00 10:00 13:00 16:00 19:00 10°

16:00 19:00 22:00 01:00 04:00 07:00 10:00 13:00 16:00 19:00

Figure E4. In situ measurement provided by Cluster 3 spacecraft on the 23rd of June 2003. The legend is the same than in Figure 1.

NGUYEN ET AL.

28 of 31
NWI Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

ADVANCING EARTH
AND SPACE SCIENCE

N,(cm~?)

B (nT)

07:00 10:00 13:00

V(km/s)

07:00 10:00 13:00
= =
2 a
> 73
or E
yi. =<
ras >
2 LX
2.0
c
2 15
pe)
Y
5 10
ov 0.5
0.0

07:00 10:00 13:00

Figure E5. In situ measurement provided by ARTEMIS B spacecraft on the 24th of April 2013. The legend is the same than in Figure 1.

NGUYEN ET AL. 29 of 31
A wrt | , °
mY Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

ADVANCING EARTH
AND SPACE SCIENCE

Acknowledgments

The authors thank the French Ministry
of Defense for the funding of this work.
The authors acknowledge the support of
the THEMIS, Cluster, Double Star and
MMS instrument and science team as
well as Zdenek Némecek for the fruitful
discussions and support.

NGUYEN ET AL.

Data Availability Statement

THEMIS data are accessible via the NASA Coordinated Data Analysis web (https://cdaweb.sci.gsfc.nasa.gov/
index.html/). Cluster and Double Star data are accessible via the Cluster and Double Star Science archive (http://
csa.esac.esa.int/). All of our trained algorithms and events list can be found online at https://doi.org/10.5281/

zenodo.5668298 (Nguyen, 2021).

References

Argall, M. R., Small, C. R., Piatt, S., Breen, L., Petrik, M., Kokkonen, K., et al. (2020). Mms sitl ground loop: Automating the burst data selection
process. Frontiers in Astronomy and Space Sciences, 7, 54. https://doi.org/10.3389/fspas.2020.00054

Auster, H. U., Glassmeier, K. H., Magnes, W., Aydogar, O., Baumjohann, W., Constantinescu, D., et al. (2008). The THEMIS fluxgate magnetometer. Scientific Studies of Reading, 141(1-4), 235-264. https://doi.org/10.1007/s11214-008-9365-9

Balogh, A., Carr, C., Acufia, M., Dunlop, M., Beek, T., Brown, P., et al. (2001). The cluster magnetic field investigation: Overview of in-flight
performance and initial results. Annales Geophysicae, 19. https://doi.org/10.5194/angeo-19-1207-2001

Berchem, J., & Russell, C. T. (1982). The thickness of the magnetopause current layer: ISEE | and 2 observations. Journal of Geophysical Research, 87(A4), 2108-2114. https://doi.org/10.1029/ja087i1a04p02108

Berkson, J. (1944). Application of the logistic function to bio-assay. Journal of the American Statistical Association, 39(227), 357-365. https://
doi.org/10.1080/01621459.1944.10500699

Breiman, L., Friedman, J. H., Olshen, R. A., & Stone, C. J. (1984). Classification and regression trees. Wadsworth and Brooks. https://doi.
org/10.1201/9781315139470

Breuillard, H., Dupuis, R., Retino, A., Le Contel, O., Amaya, J., & Lapenta, G. (2020). Automatic classification of plasma regions in near-earth
space with supervised machine learning: Application to magnetospheric multi scale 2016-2019 observations. Frontiers in Astronomy and
Space Sciences, 7, 55. https://doi.org/10.3389/fspas.2020.00055

Brown, I., & Mues, C. (2012). An experimental comparison of classification algorithms for imbalanced credit scoring data sets. Expert Systems
with Applications, 39, 3446-3453. https://doi.org/10.1016/j.eswa.2011.09.033

Burgess, D. (1995). Foreshock-shock interaction at collisionless quasi-parallel shocks. Advances in Space Research, 15(8—9), 159-169. https://
doi.org/10.1016/0273-1177(94)00098-1

Camporeale, E., Caré, A., & Borovsky, J. E. (2017). Classification of solar wind with machine learning. Journal of Geophysical Research: Space
Physics, 122(1110), 910920-911010. https://doi.org/10.1002/2017JA024383

Carr, C., Brown, P., Zhang, T. L., Gloag, J., Horbury, T., Lucek, E., et al. (2005). The double star magnetic field investigation: Instrument design,
performance and s of the first year’s observations. Annales Geophysicae, 23(8), 2713-2732. https://doi.org/10.5 194/angeo-23-27 13-2005

Fairfield, D. H. (1971). Average and unusual locations of the Earth’s magnetopause and bow shock. Journal of Geophysical Research, 76(28),
6700-6716. https://doi.org/10.1029/ja0761028 p06700

Farris, M. H., & Russell, C. T. (1994). Determining the standoff distance of the bow shock: Mach number dependence and use of models. Journal
of Geophysical Research, 99(A9), 17681. https://doi.org/10.1029/94ja01020

Fazakerley, A. N., Carter, P. J., Watson, G., Spencer, A., Sun, Y. Q., Coker, J., et al. (2005). The double star plasma electron and current experiment. Annales Geophysicae, 23(8), 2733-2756. https://do1.org/10.5194/angeo-23-2733-2005

Friedman, J. H. (2001). Greedy function approximation: A gradient boosting machine. Annals of Statistics, 29(5), 1189-1232. https://doi.
org/10.1214/aos/1013203451

Génot, V., Jacquey, C., Bouchemit, M., Gangloff, M., Fedorov, A., Lavraud, B., et al. (2010). Space weather applications with CDPP/AMDA.
Advances in Space Research, 45(9), 1145-1155. https://doi.org/10.1016/j.asr.2009.11.010

Haaland, S., Reistad, J., Tenfjord, P., Gjerloev, J., Maes, L., DeKeyser, J., et al. (2014). Characteristics of the flank magnetopause: Cluster observations. Journal of Geophysical Research: Space Physics, 119(11), 9019-9037. https://doi.org/10.1002/2014ja020539

Hasegawa, H. (2012). Structure and dynamics of the magnetopause and its boundary layers. Monographs on Environment, Earth and Planets,
1(2), 71-119. https://doi.org/10.5047/meep.2012.00102.0071

Jelinek, K., Némeéek, Z., & Safrankova, J. (2012). A new approach to magnetopause and bow shock modeling based on automated region identification. Journal of Geophysical Research: Space Physics, 117(A5). https://doi.org/10.1029/201 1ja017252

Jerab, M., Némeéek, Z.., Safrankova, J., Jelinek, K., & Mérka, J. (2005). Improved bow shock model with dependence on the IMF strength. Planetary and Space Science, 53(1-3), 85-93. https://doi.org/10.1016/j.pss.2004.09.032

Karimabadi, H., Sipes, T. B., Wang, Y., Lavraud, B., & Roberts, A. (2009). A new multivariate time series data analysis technique: Automated
detection of flux transfer events using Cluster data. Journal of Geophysical Research, 114(A6). https://doi.org/10.1029/2009ja014202

Kruparova, O., Krupar, V., A afrankova, J., Némecek, Z., Maksimovic, M., Santolik, O., et al. (2019). Statistical survey of the terrestrial bow shock
observed by the cluster spacecraft. Journal of Geophysical Research: Space Physics, 124(3), 1539-1547. https://doi.org/10.1029/2018JA026272

Lin, R. L., Zhang, X. X., Liu, S. Q., Wang, Y. L., & Gong, J. C. (2010). A three-dimensional asymmetric magnetopause model. Journal of Geophysical Research: Space Physics, 115(A4). https://doi.org/10.1029/2009ja014235

Liu, Z., Lu, J. Y., Wang, C., Kabin, K., Zhao, J. S., Wang, M., et al. (2015). Space Physics A three-dimensional high Mach number asymmetric
magnetopause model from global MHD simulation. Journal of Geophysical Research, 5645-5666. https://doi.org/10.1002/2014JA020961

Lukin, A. S., Artemyev, A. V., Petrukovich, A. A., Angelopoulos, V., Runov, A., Wang, C.-P., & Yushkov, E. V. (2019). Spatial scales and plasma
properties of the distant magnetopause: Evidence for selective ion and electron transport. Journal of Geophysical Research: Space Physics,
124(7), 5027-5041. https://doi.org/10.1029/2019ja026638

McFadden, J. P., Carlson, C. W., Larson, D., Ludlam, M., Abiad, R., Elliott, B., et al. (2008). The THEMIS ESA plasma instrument and in-flight
calibration. Space Science Reviews, 141(1—-4), 277-302. https://doi.org/10.1007/s11214-008-9440-2

McKinney, W. (2010). Data structures for statistical computing in Python. In S. van der Walt, & J. Millman (Eds.), Proceedings of the 9th Python
in Science Conference (pp. 56-61). https://doi.org/10.25080/Majora-92bf1922-00a

Némeéek, Z., Safrankova, J., & Simtnek, J. (2020). An examination of the magnetopause position and shape based upon new observations.
In Dayside magnetosphere interactions (pp. , 135-151). American Geophysical Union (AGU). https://doi.org/10.1002/9781119509592.ch8

30 of 31
vrij
rid
ADVANCING EARTH
AND SPACE SCIENCE

NGUYEN ET AL.

Journal of Geophysical Research: Space Physics 10.1029/2021JA029773

Nguyen, G., Aunai, N., Michotte de Welle, B., Jeandet, A., Lavraud, B., & Fontaine, D. (2022a). Massive multi-mission statistical study and analytical modeling of the Earth's magnetopause: 2. Shape and location. Journal of Geophysical Research: Space Physics, 127, e2021JA029774.
https://doi.org/10.1029/2021ja029774

Nguyen, G., Aunai, N., Michotte de Welle, B., Jeandet, A., Lavraud, B., & Fontaine, D. (2022b). Massive multi-mission statistical study and
analytical modeling of the Earth's magnetopause: 3. An asymmetric non indented magnetopause analytical model. Journal of Geophysical
Research: Space Physics, 127, €2021JA030112. https://doi.org/10.1029/2021ja030112

Nguyen, G., Aunai, N., Michotte de Welle, B., Jeandet, A., Lavraud, B., & Fontaine, D. (2022c). Massive multi-mission statistical study and
analytical modeling of the Earth's magnetopause: 4. On the near-cusp magnetopause indentation. Journal of Geophysical Research: Space
Physics, 127, €2021JA029776. https://doi.org/10.1029/2021ja029776

Nguyen (2021). Gautiernguyen/in-situ_Events_lists: In-situ events list. Zenodo. https://doi.org/10.528 1/zenodo.5668298

Niculescu-Mizil, A., & Caruana, R. (2005). Obtaining calibrated probabilities from boosting. In Proceedings of the twenty-first conference on
uncertainty in artificial intelligence (pp. 413-420). AUAI Press.

Olshevsky, V., Khotyaintsev, Y. V., Lalti, A., Divin, A., Delzanno, G. L., Anderzen, S., et al. (2021). Automated classification of plasma regions
using 3D particle energy distributions. Journal of Geophysical Research: Space Physics, 126(10). https://doi.org/10.1029/2021ja029620

Panov, E. V., Biichner, J., Franz, M., Korth, A., Savin, S. P., Reme, H., & Fornacon, K.-H. (2008). High-latitude Earth’s magnetopause outside the
cusp: Cluster observations. Journal of Geophysical Research: Space Physics, 113(A1). https://doi.org/10.1029/2006ja012123

Paschmann, G., Haaland, S. E., Phan, T. D., Sonnerup, B. U. O., Burch, J. L., Torbert, R. B., et al. (2018). Large-scale survey of the structure of the
dayside magnetopause by MMS. Journal of Geophysical Research: Space Physics, 123(3), 2018-2033. https://doi.org/10.1002/2017ja025121

Pedregosa, F., Varoquaux, G., Gramfort, A., Michel, V., Thirion, B., Grisel, O., et al. (2011). Scikit-learn: Machine learning in Python. Journal
of Machine Learning Research, 12, 2825-2830.

Phan, T. D., & Paschmann, G. (1996). Low-latitude dayside magnetopause and boundary layer for high magnetic shear: 1. Structure and motion.
Journal of Geophysical Research: Space Physics, 101(A4), 7801-7815. https://doi.org/10.1029/95ja03752

Pollock, C., Moore, T., Jacques, A., Burch, J., Gliese, U., Saito, Y., et al. (2016). Fast plasma investigation for magnetospheric multiscale. Space
Science Reviews, 199(1—4), 331-406. https://doi.org/10.1007/s11214-016-0245-4

Reme, H., Aoustin, C., Bosqued, J. M., Dand ouras, I., Lavraud, B., Sauvaud, J. A., et al. (2001). First multispacecraft ion measurements in and
near the Earth’s magnetosphere with the identical Cluster ion spectrometry (CIS) experiment. Annales Geophysicae, 19(10/12), 1303-1354.
https://doi.org/10.5194/angeo-19-1303-2001

Russell, C. T., Anderson, B. J., Baumjohann, W., Bromund, K. R., Dearborn, D., Fischer, D., et al. (2016). The magnetospheric multiscale magnetometers. Space Science Reviews, 1991-4), 189-256. https://doi.org/10.1007/s11214-014-0057-3

Safrankova, J., Némecek, Z., DuSik, v., Pfech, L., Sibeck, D. G., & Borodkova, N. N. (2002). The magnetopause shape and location: A comparison of the interball and geotail observations with models. Annales Geophysicae, 20(3), 301-309. https://doi.org/10.5 194/angeo-20-301-2002

Shue, J. H., Chao, J. K., Fu, H. C., Russell, C. T., Song, P., Khurana, K. K., & Singer, H. J. (1997). A new functional form to study the solar wind control of the magnetopause size and shape. Journal of Geophysical Research: Space Physics, 102(A5), 9497-9512. https://doi.
org/10.1029/97ja00196

Wang, Y., Sibeck, D. G., Merka, J., Boardsen, S. A., Karimabadi, H., Sipes, T. B., et al. (2013). A new three-dimensional magnetopause model
with a support vector regression machine and a large database of multiple spacecraft observations. Journal of Geophysical Research: Space
Physics, 118(5), 2173-2184. https://doi.org/10.1002/jgra.50226

Wu, D. J., Chao, J. K., & Lepping, R. P. (2000). Interaction between an interplanetary magnetic cloud and the earth’s magnetosphere: Motions of
the bow shock. Journal of Geophysical Research: Space Physics, 105(A6), 12627-12638. https://doi.org/10.1029/1999}a000265

31 of 31
